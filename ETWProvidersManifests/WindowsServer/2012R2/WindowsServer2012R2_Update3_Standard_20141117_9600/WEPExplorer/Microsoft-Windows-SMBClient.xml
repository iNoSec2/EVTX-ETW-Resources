<Providers>
    <Provider>
        <Name>Microsoft-Windows-SMBClient</Name>
        <Metadata>
            <Guid>{988C59C5-0A1C-45B6-A555-0C62276E327D}</Guid>
            <ResourceFilePath>C:\Windows\system32\drivers\mrxsmb.sys</ResourceFilePath>
            <ParameterFilePath></ParameterFilePath>
            <MessageFilePath>C:\Windows\system32\drivers\mrxsmb.sys</MessageFilePath>
            <HelpLink>http://go.microsoft.com/fwlink/events.asp?CoName=Microsoft%20Corporation&amp;ProdName=Microsoft%c2%ae%20Windows%c2%ae%20Operating%20System&amp;ProdVer=6.3.9600.16384&amp;FileName=mrxsmb.sys&amp;FileVer=6.3.9600.16384</HelpLink>
            <PublisherMessage>Microsoft-Windows-SMBClient</PublisherMessage>
            <Channels>
                <Channel>
                    <Message>Microsoft-Windows-SMBClient/HelperClassDiagnostic</Message>
                    <Path>Microsoft-Windows-SMBClient/HelperClassDiagnostic</Path>
                    <Index>0</Index>
                    <Id>16</Id>
                    <Imported>false</Imported>
                </Channel>
                <Channel>
                    <Message>Microsoft-Windows-SMBClient/ObjectStateDiagnostic</Message>
                    <Path>Microsoft-Windows-SMBClient/ObjectStateDiagnostic</Path>
                    <Index>1</Index>
                    <Id>17</Id>
                    <Imported>false</Imported>
                </Channel>
                <Channel>
                    <Message>Microsoft-Windows-SMBClient/Operational</Message>
                    <Path>Microsoft-Windows-SMBClient/Operational</Path>
                    <Index>2</Index>
                    <Id>18</Id>
                    <Imported>false</Imported>
                </Channel>
                <Channel>
                    <Message>Microsoft-Windows-SMBClient/XPerfAnalytic</Message>
                    <Path>Microsoft-Windows-SMBClient/Analytic</Path>
                    <Index>3</Index>
                    <Id>19</Id>
                    <Imported>false</Imported>
                </Channel>
                <Channel>
                    <Message>Microsoft-Windows-SMBClient/Diagnostic</Message>
                    <Path>Microsoft-Windows-SmbClient/Diagnostic</Path>
                    <Index>4</Index>
                    <Id>20</Id>
                    <Imported>false</Imported>
                </Channel>
                <Channel>
                    <Message>Microsoft-Windows-SMBClient/Connectivity</Message>
                    <Path>Microsoft-Windows-SmbClient/Connectivity</Path>
                    <Index>5</Index>
                    <Id>21</Id>
                    <Imported>false</Imported>
                </Channel>
                <Channel>
                    <Message>Microsoft-Windows-SMBClient/Security</Message>
                    <Path>Microsoft-Windows-SmbClient/Security</Path>
                    <Index>6</Index>
                    <Id>22</Id>
                    <Imported>false</Imported>
                </Channel>
            </Channels>
            <Levels>
                <Level>
                    <Message>Error</Message>
                    <Name>win:Error</Name>
                    <Value>2</Value>
                </Level>
                <Level>
                    <Message>Warning</Message>
                    <Name>win:Warning</Name>
                    <Value>3</Value>
                </Level>
                <Level>
                    <Message>Information</Message>
                    <Name>win:Informational</Name>
                    <Value>4</Value>
                </Level>
                <Level>
                    <Message>Verbose</Message>
                    <Name>win:Verbose</Name>
                    <Value>5</Value>
                </Level>
            </Levels>
            <Tasks>
            </Tasks>
            <Opcodes>
                <Opcode>
                    <Message>Info</Message>
                    <Name>win:Info</Name>
                    <Value>0</Value>
                    <Task>0</Task>
                </Opcode>
                <Opcode>
                    <Message>Server Error</Message>
                    <Name>Server</Name>
                    <Value>11</Value>
                    <Task>0</Task>
                </Opcode>
                <Opcode>
                    <Message>Cached Error</Message>
                    <Name>Cache</Name>
                    <Value>12</Value>
                    <Task>0</Task>
                </Opcode>
                <Opcode>
                    <Message>Initialize Security Context Error</Message>
                    <Name>ISC</Name>
                    <Value>13</Value>
                    <Task>0</Task>
                </Opcode>
                <Opcode>
                    <Message>Security Signature Error</Message>
                    <Name>Signing</Name>
                    <Value>14</Value>
                    <Task>0</Task>
                </Opcode>
                <Opcode>
                    <Message>Start State</Message>
                    <Name>ut:Start</Name>
                    <Value>180</Value>
                    <Task>0</Task>
                </Opcode>
                <Opcode>
                    <Message>End State</Message>
                    <Name>ut:End</Name>
                    <Value>181</Value>
                    <Task>0</Task>
                </Opcode>
            </Opcodes>
            <Keywords>
                <Keyword>
                    <Message></Message>
                    <Name>Smb_Perf</Name>
                    <Value>1</Value>
                </Keyword>
                <Keyword>
                    <Message></Message>
                    <Name>Networking_Perf</Name>
                    <Value>2</Value>
                </Keyword>
                <Keyword>
                    <Message></Message>
                    <Name>Smb_Info</Name>
                    <Value>4</Value>
                </Keyword>
                <Keyword>
                    <Message></Message>
                    <Name>InfoCache_Info</Name>
                    <Value>8</Value>
                </Keyword>
                <Keyword>
                    <Message></Message>
                    <Name>Smb_TFO</Name>
                    <Value>16</Value>
                </Keyword>
                <Keyword>
                    <Message></Message>
                    <Name>Smb_MultiChannel</Name>
                    <Value>32</Value>
                </Keyword>
                <Keyword>
                    <Message></Message>
                    <Name>Smb_Connectivity</Name>
                    <Value>64</Value>
                </Keyword>
                <Keyword>
                    <Message></Message>
                    <Name>Smb_Authentication</Name>
                    <Value>128</Value>
                </Keyword>
                <Keyword>
                    <Message></Message>
                    <Name>Smb_Authorization</Name>
                    <Value>256</Value>
                </Keyword>
                <Keyword>
                    <Message></Message>
                    <Name>Smb_Security</Name>
                    <Value>512</Value>
                </Keyword>
                <Keyword>
                    <Message></Message>
                    <Name>PacketStart</Name>
                    <Value>1073741824</Value>
                </Keyword>
                <Keyword>
                    <Message></Message>
                    <Name>PacketEnd</Name>
                    <Value>2147483648</Value>
                </Keyword>
                <Keyword>
                    <Message></Message>
                    <Name>ut:SendPath</Name>
                    <Value>4294967296</Value>
                </Keyword>
                <Keyword>
                    <Message></Message>
                    <Name>ut:ReceivePath</Name>
                    <Value>8589934592</Value>
                </Keyword>
                <Keyword>
                    <Message></Message>
                    <Name>ut:Packet</Name>
                    <Value>4398046511104</Value>
                </Keyword>
                <Keyword>
                    <Message></Message>
                    <Name>ut:Diagnostic</Name>
                    <Value>70368744177664</Value>
                </Keyword>
                <Keyword>
                    <Message></Message>
                    <Name>PduFull</Name>
                    <Value>140737488355328</Value>
                </Keyword>
            </Keywords>
        </Metadata>
        <EventMetadata>
            <Event>
                <Id>101</Id>
                <Version>0</Version>
                <Channel>Microsoft-Windows-SMBClient/HelperClassDiagnostic</Channel>
                <Level>Error</Level>
                <Message><![CDATA[
Create SrvCall Error: %1 Location: %2 Context: %3]]></Message>
                <Template><![CDATA[
<template xmlns="http://schemas.microsoft.com/win/2004/08/events">
  <data name="ErrorCode" inType="win:UInt32" outType="win:ErrorCode"/>
  <data name="Location" inType="win:UInt32" outType="xs:unsignedInt"/>
  <data name="Context" inType="win:UInt32" outType="xs:unsignedInt"/>
</template>
]]></Template>
            </Event>
            <Event>
                <Id>201</Id>
                <Version>0</Version>
                <Channel>Microsoft-Windows-SMBClient/HelperClassDiagnostic</Channel>
                <Level>Error</Level>
                <Message><![CDATA[
Session Setup Error: %1 Location: %2 Context: %3]]></Message>
                <Template><![CDATA[
<template xmlns="http://schemas.microsoft.com/win/2004/08/events">
  <data name="ErrorCode" inType="win:UInt32" outType="win:ErrorCode"/>
  <data name="Location" inType="win:UInt32" outType="xs:unsignedInt"/>
  <data name="Context" inType="win:UInt32" outType="xs:unsignedInt"/>
</template>
]]></Template>
            </Event>
            <Event>
                <Id>301</Id>
                <Version>0</Version>
                <Channel>Microsoft-Windows-SMBClient/HelperClassDiagnostic</Channel>
                <Level>Error</Level>
                <Message><![CDATA[
Tree Connect Error: %1 Location: %2 Context: %3]]></Message>
                <Template><![CDATA[
<template xmlns="http://schemas.microsoft.com/win/2004/08/events">
  <data name="ErrorCode" inType="win:UInt32" outType="win:ErrorCode"/>
  <data name="Location" inType="win:UInt32" outType="xs:unsignedInt"/>
  <data name="Context" inType="win:UInt32" outType="xs:unsignedInt"/>
</template>
]]></Template>
            </Event>
            <Event>
                <Id>401</Id>
                <Version>0</Version>
                <Channel>Microsoft-Windows-SMBClient/HelperClassDiagnostic</Channel>
                <Level>Error</Level>
                <Message><![CDATA[
Create VNetRoot Error: %1 Location: %2 Context: %3]]></Message>
                <Template><![CDATA[
<template xmlns="http://schemas.microsoft.com/win/2004/08/events">
  <data name="ErrorCode" inType="win:UInt32" outType="win:ErrorCode"/>
  <data name="Location" inType="win:UInt32" outType="xs:unsignedInt"/>
  <data name="Context" inType="win:UInt32" outType="xs:unsignedInt"/>
</template>
]]></Template>
            </Event>
            <Event>
                <Id>501</Id>
                <Version>0</Version>
                <Channel>Microsoft-Windows-SMBClient/HelperClassDiagnostic</Channel>
                <Level>Error</Level>
                <Message><![CDATA[
Create File Error: %1 Location: %2 Context: %3]]></Message>
                <Template><![CDATA[
<template xmlns="http://schemas.microsoft.com/win/2004/08/events">
  <data name="ErrorCode" inType="win:UInt32" outType="win:ErrorCode"/>
  <data name="Location" inType="win:UInt32" outType="xs:unsignedInt"/>
  <data name="Context" inType="win:UInt32" outType="xs:unsignedInt"/>
</template>
]]></Template>
            </Event>
            <Event>
                <Id>2000</Id>
                <Version>0</Version>
                <Channel>Microsoft-Windows-SMBClient/Diagnostic</Channel>
                <Level>Information</Level>
                <Message><![CDATA[
Packet Fragment (%2 bytes)]]></Message>
                <Template><![CDATA[
<template xmlns="http://schemas.microsoft.com/win/2004/08/events">
  <data name="ReassembledEventID" inType="win:UInt16" outType="xs:unsignedShort"/>
  <data name="FragmentSize" inType="win:UInt32" outType="xs:unsignedInt"/>
  <data name="FragmentData" inType="win:Binary" outType="xs:hexBinary" length="FragmentSize"/>
</template>
]]></Template>
            </Event>
            <Event>
                <Id>20001</Id>
                <Version>0</Version>
                <Channel>Microsoft-Windows-SMBClient/HelperClassDiagnostic</Channel>
                <Level>Information</Level>
                <Message><![CDATA[
Transitioned to State: %1 Context: %2]]></Message>
                <Template><![CDATA[
<template xmlns="http://schemas.microsoft.com/win/2004/08/events">
  <data name="CurrentOrNextState" inType="win:UInt8" outType="xs:unsignedByte"/>
  <data name="Context" inType="win:UInt32" outType="xs:unsignedInt"/>
</template>
]]></Template>
            </Event>
            <Event>
                <Id>30103</Id>
                <Version>0</Version>
                <Channel>Microsoft-Windows-SMBClient/XPerfAnalytic</Channel>
                <Level>Verbose</Level>
                <Keyword>Smb_Perf</Keyword>
                <Message><![CDATA[
SMB exchange suspended: RxContext %1 Exchange %2 ListHead %3]]></Message>
                <Template><![CDATA[
<template xmlns="http://schemas.microsoft.com/win/2004/08/events">
  <data name="RxContext" inType="win:Pointer" outType="win:HexInt64"/>
  <data name="Exchange" inType="win:Pointer" outType="win:HexInt64"/>
  <data name="ListHead" inType="win:Pointer" outType="win:HexInt64"/>
</template>
]]></Template>
            </Event>
            <Event>
                <Id>30104</Id>
                <Version>0</Version>
                <Channel>Microsoft-Windows-SMBClient/XPerfAnalytic</Channel>
                <Level>Verbose</Level>
                <Keyword>Smb_Perf</Keyword>
                <Message><![CDATA[
SMB exchange resumed: RxContext %1 Exchange %2 ExchangeState %3 ExchangeStatus %4]]></Message>
                <Template><![CDATA[
<template xmlns="http://schemas.microsoft.com/win/2004/08/events">
  <data name="RxContext" inType="win:Pointer" outType="win:HexInt64"/>
  <data name="Exchange" inType="win:Pointer" outType="win:HexInt64"/>
  <data name="ExchangeState" inType="win:UInt32" outType="xs:unsignedInt"/>
  <data name="ExchangeStatus" inType="win:UInt32" outType="xs:unsignedInt"/>
</template>
]]></Template>
            </Event>
            <Event>
                <Id>30105</Id>
                <Version>0</Version>
                <Channel>Microsoft-Windows-SMBClient/XPerfAnalytic</Channel>
                <Level>Verbose</Level>
                <Keyword>Smb_Perf</Keyword>
                <Message><![CDATA[
SMB buffer context suspended: BufferCtxt %1 Exchange %2 MidCharge %3 Window %4 CurrentWindowLimit %5 ThrottlingWindowLimit %6 CurrentWindowSize %7]]></Message>
                <Template><![CDATA[
<template xmlns="http://schemas.microsoft.com/win/2004/08/events">
  <data name="BufferCtxt" inType="win:Pointer" outType="win:HexInt64"/>
  <data name="Exchange" inType="win:Pointer" outType="win:HexInt64"/>
  <data name="MidCharge" inType="win:UInt32" outType="xs:unsignedInt"/>
  <data name="Window" inType="win:Pointer" outType="win:HexInt64"/>
  <data name="CurrentWindowLimit" inType="win:UInt32" outType="xs:unsignedInt"/>
  <data name="ThrottlingWindowLimit" inType="win:UInt32" outType="xs:unsignedInt"/>
  <data name="CurrentWindowSize" inType="win:UInt32" outType="xs:unsignedInt"/>
</template>
]]></Template>
            </Event>
            <Event>
                <Id>30106</Id>
                <Version>0</Version>
                <Channel>Microsoft-Windows-SMBClient/XPerfAnalytic</Channel>
                <Level>Verbose</Level>
                <Keyword>Smb_Perf</Keyword>
                <Message><![CDATA[
SMB buffer context resumed: BufferCtxt %1 Exchange %2 MidCharge %3 Window %4 CurrentWindowLimit %5 ThrottlingWindowLimit %6 CurrentWindowSize %7]]></Message>
                <Template><![CDATA[
<template xmlns="http://schemas.microsoft.com/win/2004/08/events">
  <data name="BufferCtxt" inType="win:Pointer" outType="win:HexInt64"/>
  <data name="Exchange" inType="win:Pointer" outType="win:HexInt64"/>
  <data name="MidCharge" inType="win:UInt32" outType="xs:unsignedInt"/>
  <data name="Window" inType="win:Pointer" outType="win:HexInt64"/>
  <data name="CurrentWindowLimit" inType="win:UInt32" outType="xs:unsignedInt"/>
  <data name="ThrottlingWindowLimit" inType="win:UInt32" outType="xs:unsignedInt"/>
  <data name="CurrentWindowSize" inType="win:UInt32" outType="xs:unsignedInt"/>
</template>
]]></Template>
            </Event>
            <Event>
                <Id>30108</Id>
                <Version>0</Version>
                <Channel>Microsoft-Windows-SMBClient/XPerfAnalytic</Channel>
                <Level>Error</Level>
                <Keyword>Smb_Perf Smb_Info</Keyword>
                <Message><![CDATA[
SMB Mid window blocked: Window %1 HungSession %2]]></Message>
                <Template><![CDATA[
<template xmlns="http://schemas.microsoft.com/win/2004/08/events">
  <data name="Window" inType="win:Pointer" outType="win:HexInt64"/>
  <data name="HungSession" inType="win:UInt32" outType="xs:unsignedInt"/>
</template>
]]></Template>
            </Event>
            <Event>
                <Id>30109</Id>
                <Version>0</Version>
                <Channel>Microsoft-Windows-SMBClient/XPerfAnalytic</Channel>
                <Level>Error</Level>
                <Keyword>Smb_Perf Smb_Info</Keyword>
                <Message><![CDATA[
SMB rechunk multi-credit request: BufferCtxt %1 Exchange %2 MidCharge %3 Window %4 CurrentWindowLimit %5 ThrottlingWindowLimit %6 CurrentWindowSize %7]]></Message>
                <Template><![CDATA[
<template xmlns="http://schemas.microsoft.com/win/2004/08/events">
  <data name="BufferCtxt" inType="win:Pointer" outType="win:HexInt64"/>
  <data name="Exchange" inType="win:Pointer" outType="win:HexInt64"/>
  <data name="MidCharge" inType="win:UInt32" outType="xs:unsignedInt"/>
  <data name="Window" inType="win:Pointer" outType="win:HexInt64"/>
  <data name="CurrentWindowLimit" inType="win:UInt32" outType="xs:unsignedInt"/>
  <data name="ThrottlingWindowLimit" inType="win:UInt32" outType="xs:unsignedInt"/>
  <data name="CurrentWindowSize" inType="win:UInt32" outType="xs:unsignedInt"/>
</template>
]]></Template>
            </Event>
            <Event>
                <Id>30110</Id>
                <Version>0</Version>
                <Channel>Microsoft-Windows-SMBClient/XPerfAnalytic</Channel>
                <Level>Verbose</Level>
                <Keyword>Smb_Perf</Keyword>
                <Message><![CDATA[
SMB initialize Mid window: Server %2 Window %3]]></Message>
                <Template><![CDATA[
<template xmlns="http://schemas.microsoft.com/win/2004/08/events">
  <data name="ServerNameLength" inType="win:UInt16" outType="xs:unsignedShort"/>
  <data name="ServerName" inType="win:UnicodeString" outType="xs:string" length="ServerNameLength"/>
  <data name="MidWindow" inType="win:Pointer" outType="win:HexInt64"/>
</template>
]]></Template>
            </Event>
            <Event>
                <Id>30111</Id>
                <Version>0</Version>
                <Channel>Microsoft-Windows-SMBClient/XPerfAnalytic</Channel>
                <Level>Verbose</Level>
                <Keyword>Smb_Perf</Keyword>
                <Message><![CDATA[
SMB Mid window state: Window %1 CurrentWindowSize %2 CurrentWindowLimit %3 ThrottlingWindowLimit %4 OldestPendingMid %5 NextAvailableMid %6 CreditsGranted %7]]></Message>
                <Template><![CDATA[
<template xmlns="http://schemas.microsoft.com/win/2004/08/events">
  <data name="MidWindow" inType="win:Pointer" outType="win:HexInt64"/>
  <data name="CurrentWindowSize" inType="win:UInt32" outType="xs:unsignedInt"/>
  <data name="CurrentWindowLimit" inType="win:UInt32" outType="xs:unsignedInt"/>
  <data name="ThrottlingWindowLimit" inType="win:UInt32" outType="xs:unsignedInt"/>
  <data name="OldestPendingMid" inType="win:UInt64" outType="xs:unsignedLong"/>
  <data name="NextAvailableMid" inType="win:UInt64" outType="xs:unsignedLong"/>
  <data name="CreditsGranted" inType="win:Int32" outType="xs:int"/>
</template>
]]></Template>
            </Event>
            <Event>
                <Id>30112</Id>
                <Version>0</Version>
                <Channel>Microsoft-Windows-SMBClient/XPerfAnalytic</Channel>
                <Level>Verbose</Level>
                <Keyword>Smb_Perf</Keyword>
                <Message><![CDATA[
SMB teardown Mid window: Server %2 Window %3]]></Message>
                <Template><![CDATA[
<template xmlns="http://schemas.microsoft.com/win/2004/08/events">
  <data name="ServerNameLength" inType="win:UInt16" outType="xs:unsignedShort"/>
  <data name="ServerName" inType="win:UnicodeString" outType="xs:string" length="ServerNameLength"/>
  <data name="MidWindow" inType="win:Pointer" outType="win:HexInt64"/>
</template>
]]></Template>
            </Event>
            <Event>
                <Id>30113</Id>
                <Version>0</Version>
                <Channel>Microsoft-Windows-SMBClient/XPerfAnalytic</Channel>
                <Level>Verbose</Level>
                <Keyword>Smb_Perf</Keyword>
                <Message><![CDATA[
SMB copy data completion: Status %1 VcEndpoint %2]]></Message>
                <Template><![CDATA[
<template xmlns="http://schemas.microsoft.com/win/2004/08/events">
  <data name="Status" inType="win:UInt32" outType="xs:unsignedInt"/>
  <data name="VcEndpoint" inType="win:Pointer" outType="win:HexInt64"/>
</template>
]]></Template>
            </Event>
            <Event>
                <Id>30114</Id>
                <Version>0</Version>
                <Channel>Microsoft-Windows-SMBClient/XPerfAnalytic</Channel>
                <Level>Verbose</Level>
                <Keyword>Smb_Perf</Keyword>
                <Message><![CDATA[
SMB send completion: Status %1 VcEndpoint %2]]></Message>
                <Template><![CDATA[
<template xmlns="http://schemas.microsoft.com/win/2004/08/events">
  <data name="Status" inType="win:UInt32" outType="xs:unsignedInt"/>
  <data name="VcEndpoint" inType="win:Pointer" outType="win:HexInt64"/>
</template>
]]></Template>
            </Event>
            <Event>
                <Id>30203</Id>
                <Version>0</Version>
                <Channel>Microsoft-Windows-SMBClient/XPerfAnalytic</Channel>
                <Level>Information</Level>
                <Keyword>Networking_Perf</Keyword>
                <Message><![CDATA[
WSK connect: SocketAddress %2 VcEndpoint %3 Socket %4]]></Message>
                <Template><![CDATA[
<template xmlns="http://schemas.microsoft.com/win/2004/08/events">
  <data name="RemoteAddressLength" inType="win:UInt32" outType="xs:unsignedInt"/>
  <data name="RemoteAddress" inType="win:Binary" outType="win:SocketAddress" length="RemoteAddressLength"/>
  <data name="VcEndpoint" inType="win:Pointer" outType="win:HexInt64"/>
  <data name="Socket" inType="win:Pointer" outType="win:HexInt64"/>
</template>
]]></Template>
            </Event>
            <Event>
                <Id>30204</Id>
                <Version>0</Version>
                <Channel>Microsoft-Windows-SMBClient/XPerfAnalytic</Channel>
                <Level>Information</Level>
                <Keyword>Networking_Perf</Keyword>
                <Message><![CDATA[
WSK connect completion: VcEndpoint %1 Socket %2 Status %3]]></Message>
                <Template><![CDATA[
<template xmlns="http://schemas.microsoft.com/win/2004/08/events">
  <data name="VcEndpoint" inType="win:Pointer" outType="win:HexInt64"/>
  <data name="Socket" inType="win:Pointer" outType="win:HexInt64"/>
  <data name="Status" inType="win:UInt32" outType="xs:unsignedInt"/>
</template>
]]></Template>
            </Event>
            <Event>
                <Id>30205</Id>
                <Version>0</Version>
                <Channel>Microsoft-Windows-SMBClient/XPerfAnalytic</Channel>
                <Level>Verbose</Level>
                <Keyword>Networking_Perf</Keyword>
                <Message><![CDATA[
WSK send: VcEndpoint %1 Socket %2 SendMdl %3 SendLength %4]]></Message>
                <Template><![CDATA[
<template xmlns="http://schemas.microsoft.com/win/2004/08/events">
  <data name="VcEndpoint" inType="win:Pointer" outType="win:HexInt64"/>
  <data name="Socket" inType="win:Pointer" outType="win:HexInt64"/>
  <data name="SendMdl" inType="win:Pointer" outType="win:HexInt64"/>
  <data name="SendLength" inType="win:UInt32" outType="xs:unsignedInt"/>
</template>
]]></Template>
            </Event>
            <Event>
                <Id>30206</Id>
                <Version>0</Version>
                <Channel>Microsoft-Windows-SMBClient/XPerfAnalytic</Channel>
                <Level>Verbose</Level>
                <Keyword>Networking_Perf</Keyword>
                <Message><![CDATA[
WSK send completion: VcEndpoint %1 Socket %2 SendMdl %3 SendLength %4 Status %5]]></Message>
                <Template><![CDATA[
<template xmlns="http://schemas.microsoft.com/win/2004/08/events">
  <data name="VcEndpoint" inType="win:Pointer" outType="win:HexInt64"/>
  <data name="Socket" inType="win:Pointer" outType="win:HexInt64"/>
  <data name="SendMdl" inType="win:Pointer" outType="win:HexInt64"/>
  <data name="SendLength" inType="win:UInt32" outType="xs:unsignedInt"/>
  <data name="Status" inType="win:UInt32" outType="xs:unsignedInt"/>
</template>
]]></Template>
            </Event>
            <Event>
                <Id>30207</Id>
                <Version>0</Version>
                <Channel>Microsoft-Windows-SMBClient/XPerfAnalytic</Channel>
                <Level>Verbose</Level>
                <Keyword>Networking_Perf</Keyword>
                <Message><![CDATA[
WSK receive: VcEndpoint %1 Socket %2 ReceiveMdl %3 ReceiveLength %4]]></Message>
                <Template><![CDATA[
<template xmlns="http://schemas.microsoft.com/win/2004/08/events">
  <data name="VcEndpoint" inType="win:Pointer" outType="win:HexInt64"/>
  <data name="Socket" inType="win:Pointer" outType="win:HexInt64"/>
  <data name="SendMdl" inType="win:Pointer" outType="win:HexInt64"/>
  <data name="SendLength" inType="win:UInt32" outType="xs:unsignedInt"/>
</template>
]]></Template>
            </Event>
            <Event>
                <Id>30208</Id>
                <Version>0</Version>
                <Channel>Microsoft-Windows-SMBClient/XPerfAnalytic</Channel>
                <Level>Verbose</Level>
                <Keyword>Networking_Perf</Keyword>
                <Message><![CDATA[
WSK receive completion: VcEndpoint %1 Socket %2 ReceiveMdl %3 ReceiveLength %4 Status %5]]></Message>
                <Template><![CDATA[
<template xmlns="http://schemas.microsoft.com/win/2004/08/events">
  <data name="VcEndpoint" inType="win:Pointer" outType="win:HexInt64"/>
  <data name="Socket" inType="win:Pointer" outType="win:HexInt64"/>
  <data name="SendMdl" inType="win:Pointer" outType="win:HexInt64"/>
  <data name="SendLength" inType="win:UInt32" outType="xs:unsignedInt"/>
  <data name="Status" inType="win:UInt32" outType="xs:unsignedInt"/>
</template>
]]></Template>
            </Event>
            <Event>
                <Id>30401</Id>
                <Version>0</Version>
                <Channel>Microsoft-Windows-SMBClient/XPerfAnalytic</Channel>
                <Level>Error</Level>
                <Keyword>Smb_Info</Keyword>
                <Message><![CDATA[
SMB session expired: SessionEntry %1 ServerName %3]]></Message>
                <Template><![CDATA[
<template xmlns="http://schemas.microsoft.com/win/2004/08/events">
  <data name="SessionEntry" inType="win:Pointer" outType="win:HexInt64"/>
  <data name="ServerNameLength" inType="win:UInt16" outType="xs:unsignedShort"/>
  <data name="ServerName" inType="win:UnicodeString" outType="xs:string" length="ServerNameLength"/>
</template>
]]></Template>
            </Event>
            <Event>
                <Id>30402</Id>
                <Version>0</Version>
                <Channel>Microsoft-Windows-SMBClient/XPerfAnalytic</Channel>
                <Level>Error</Level>
                <Keyword>Smb_Info</Keyword>
                <Message><![CDATA[
SMB 3 part SPN reauth: SessionEntry %1 ServiceName %3]]></Message>
                <Template><![CDATA[
<template xmlns="http://schemas.microsoft.com/win/2004/08/events">
  <data name="SessionEntry" inType="win:Pointer" outType="win:HexInt64"/>
  <data name="ServerNameLength" inType="win:UInt16" outType="xs:unsignedShort"/>
  <data name="ServerName" inType="win:UnicodeString" outType="xs:string" length="ServerNameLength"/>
</template>
]]></Template>
            </Event>
            <Event>
                <Id>30403</Id>
                <Version>0</Version>
                <Channel>Microsoft-Windows-SMBClient/XPerfAnalytic</Channel>
                <Level>Information</Level>
                <Keyword>Smb_Info</Keyword>
                <Message><![CDATA[
SMB reconnect durable open: Fcb %1 SrvOpen %2]]></Message>
                <Template><![CDATA[
<template xmlns="http://schemas.microsoft.com/win/2004/08/events">
  <data name="Fcb" inType="win:Pointer" outType="win:HexInt64"/>
  <data name="SrvOpen" inType="win:Pointer" outType="win:HexInt64"/>
</template>
]]></Template>
            </Event>
            <Event>
                <Id>30404</Id>
                <Version>0</Version>
                <Channel>Microsoft-Windows-SMBClient/XPerfAnalytic</Channel>
                <Level>Information</Level>
                <Keyword>Smb_Info</Keyword>
                <Message><![CDATA[
SMB defer open: Fcb %1 SrvOpen %2]]></Message>
                <Template><![CDATA[
<template xmlns="http://schemas.microsoft.com/win/2004/08/events">
  <data name="Fcb" inType="win:Pointer" outType="win:HexInt64"/>
  <data name="SrvOpen" inType="win:Pointer" outType="win:HexInt64"/>
</template>
]]></Template>
            </Event>
            <Event>
                <Id>30405</Id>
                <Version>0</Version>
                <Channel>Microsoft-Windows-SMBClient/XPerfAnalytic</Channel>
                <Level>Information</Level>
                <Keyword>Smb_Info</Keyword>
                <Message><![CDATA[
SMB undefer open: Fcb %1 SrvOpen %2]]></Message>
                <Template><![CDATA[
<template xmlns="http://schemas.microsoft.com/win/2004/08/events">
  <data name="Fcb" inType="win:Pointer" outType="win:HexInt64"/>
  <data name="SrvOpen" inType="win:Pointer" outType="win:HexInt64"/>
</template>
]]></Template>
            </Event>
            <Event>
                <Id>30406</Id>
                <Version>0</Version>
                <Channel>Microsoft-Windows-SMBClient/XPerfAnalytic</Channel>
                <Level>Information</Level>
                <Keyword>Smb_Info</Keyword>
                <Message><![CDATA[
SMB send[%1]: [%2] (Mid/Sid/Tid) (%3/%4/%5) MidCharge %6 Creds %7 SendLengh %8 VcEndpoint %9]]></Message>
                <Template><![CDATA[
<template xmlns="http://schemas.microsoft.com/win/2004/08/events">
  <data name="Count" inType="win:UInt32" outType="xs:unsignedInt"/>
  <data name="Command" inType="win:AnsiString" outType="xs:string"/>
  <data name="MessageId" inType="win:UInt64" outType="xs:unsignedLong"/>
  <data name="SessionId" inType="win:UInt64" outType="xs:unsignedLong"/>
  <data name="TreeId" inType="win:UInt32" outType="xs:unsignedInt"/>
  <data name="MidCharge" inType="win:UInt16" outType="xs:unsignedShort"/>
  <data name="CreditRequested" inType="win:UInt16" outType="xs:unsignedShort"/>
  <data name="SendLength" inType="win:UInt32" outType="xs:unsignedInt"/>
  <data name="VcEndpoint" inType="win:Pointer" outType="win:HexInt64"/>
</template>
]]></Template>
            </Event>
            <Event>
                <Id>30407</Id>
                <Version>0</Version>
                <Channel>Microsoft-Windows-SMBClient/XPerfAnalytic</Channel>
                <Level>Information</Level>
                <Keyword>Smb_Info</Keyword>
                <Message><![CDATA[
SMB receive: [%1] (Mid/Sid/Tid) (%2/%4/%5) Creds %6 Status %7 VcEndpoint %8]]></Message>
                <Template><![CDATA[
<template xmlns="http://schemas.microsoft.com/win/2004/08/events">
  <data name="Command" inType="win:AnsiString" outType="xs:string"/>
  <data name="MessageId" inType="win:UInt64" outType="xs:unsignedLong"/>
  <data name="AsyncId" inType="win:UInt64" outType="xs:unsignedLong"/>
  <data name="SessionId" inType="win:UInt64" outType="xs:unsignedLong"/>
  <data name="TreeId" inType="win:UInt32" outType="xs:unsignedInt"/>
  <data name="CreditGranted" inType="win:UInt16" outType="xs:unsignedShort"/>
  <data name="Status" inType="win:UInt32" outType="xs:unsignedInt"/>
  <data name="VcEndpoint" inType="win:Pointer" outType="win:HexInt64"/>
</template>
]]></Template>
            </Event>
            <Event>
                <Id>30408</Id>
                <Version>0</Version>
                <Channel>Microsoft-Windows-SMBClient/XPerfAnalytic</Channel>
                <Level>Information</Level>
                <Keyword>Smb_Info</Keyword>
                <Message><![CDATA[
SMB receive interim: [%1] (Mid/AsyncId/Sid/Tid) (%2/%3/%4/%5) Creds %6 Status %7 VcEndpoint %8]]></Message>
                <Template><![CDATA[
<template xmlns="http://schemas.microsoft.com/win/2004/08/events">
  <data name="Command" inType="win:AnsiString" outType="xs:string"/>
  <data name="MessageId" inType="win:UInt64" outType="xs:unsignedLong"/>
  <data name="AsyncId" inType="win:UInt64" outType="xs:unsignedLong"/>
  <data name="SessionId" inType="win:UInt64" outType="xs:unsignedLong"/>
  <data name="TreeId" inType="win:UInt32" outType="xs:unsignedInt"/>
  <data name="CreditGranted" inType="win:UInt16" outType="xs:unsignedShort"/>
  <data name="Status" inType="win:UInt32" outType="xs:unsignedInt"/>
  <data name="VcEndpoint" inType="win:Pointer" outType="win:HexInt64"/>
</template>
]]></Template>
            </Event>
            <Event>
                <Id>30409</Id>
                <Version>0</Version>
                <Channel>Microsoft-Windows-SMBClient/XPerfAnalytic</Channel>
                <Level>Information</Level>
                <Keyword>Smb_Info</Keyword>
                <Message><![CDATA[
SMB receive async: [%1] (AsyncId/Sid/Tid) (%3/%4/%5) Creds %6 Status %7 VcEndpoint %8]]></Message>
                <Template><![CDATA[
<template xmlns="http://schemas.microsoft.com/win/2004/08/events">
  <data name="Command" inType="win:AnsiString" outType="xs:string"/>
  <data name="MessageId" inType="win:UInt64" outType="xs:unsignedLong"/>
  <data name="AsyncId" inType="win:UInt64" outType="xs:unsignedLong"/>
  <data name="SessionId" inType="win:UInt64" outType="xs:unsignedLong"/>
  <data name="TreeId" inType="win:UInt32" outType="xs:unsignedInt"/>
  <data name="CreditGranted" inType="win:UInt16" outType="xs:unsignedShort"/>
  <data name="Status" inType="win:UInt32" outType="xs:unsignedInt"/>
  <data name="VcEndpoint" inType="win:Pointer" outType="win:HexInt64"/>
</template>
]]></Template>
            </Event>
            <Event>
                <Id>30410</Id>
                <Version>0</Version>
                <Channel>Microsoft-Windows-SMBClient/XPerfAnalytic</Channel>
                <Level>Information</Level>
                <Keyword>Smb_Info</Keyword>
                <Message><![CDATA[
SMB registry key: %1 = %2]]></Message>
                <Template><![CDATA[
<template xmlns="http://schemas.microsoft.com/win/2004/08/events">
  <data name="RegName" inType="win:UnicodeString" outType="xs:string"/>
  <data name="RegValue" inType="win:UInt32" outType="xs:unsignedInt"/>
</template>
]]></Template>
            </Event>
            <Event>
                <Id>30501</Id>
                <Version>0</Version>
                <Channel>Microsoft-Windows-SMBClient/XPerfAnalytic</Channel>
                <Level>Verbose</Level>
                <Keyword>InfoCache_Info</Keyword>
                <Message><![CDATA[
SMB update file info cache: RxContext %1 Fcb %2 FileName %4]]></Message>
                <Template><![CDATA[
<template xmlns="http://schemas.microsoft.com/win/2004/08/events">
  <data name="RxContext" inType="win:Pointer" outType="win:HexInt64"/>
  <data name="Fcb" inType="win:Pointer" outType="win:HexInt64"/>
  <data name="FileNameLength" inType="win:UInt16" outType="xs:unsignedShort"/>
  <data name="FileName" inType="win:UnicodeString" outType="xs:string" length="FileNameLength"/>
  <data name="Status" inType="win:UInt32" outType="xs:unsignedInt"/>
</template>
]]></Template>
            </Event>
            <Event>
                <Id>30502</Id>
                <Version>0</Version>
                <Channel>Microsoft-Windows-SMBClient/XPerfAnalytic</Channel>
                <Level>Verbose</Level>
                <Keyword>InfoCache_Info</Keyword>
                <Message><![CDATA[
SMB fetch file info cache: RxContext %1 Fcb %2 FileName %4 Status %5]]></Message>
                <Template><![CDATA[
<template xmlns="http://schemas.microsoft.com/win/2004/08/events">
  <data name="RxContext" inType="win:Pointer" outType="win:HexInt64"/>
  <data name="Fcb" inType="win:Pointer" outType="win:HexInt64"/>
  <data name="FileNameLength" inType="win:UInt16" outType="xs:unsignedShort"/>
  <data name="FileName" inType="win:UnicodeString" outType="xs:string" length="FileNameLength"/>
  <data name="Status" inType="win:UInt32" outType="xs:unsignedInt"/>
</template>
]]></Template>
            </Event>
            <Event>
                <Id>30503</Id>
                <Version>0</Version>
                <Channel>Microsoft-Windows-SMBClient/XPerfAnalytic</Channel>
                <Level>Verbose</Level>
                <Keyword>InfoCache_Info</Keyword>
                <Message><![CDATA[
SMB invalidate file info cache: RxContext %1 Fcb %2 FileName %4]]></Message>
                <Template><![CDATA[
<template xmlns="http://schemas.microsoft.com/win/2004/08/events">
  <data name="RxContext" inType="win:Pointer" outType="win:HexInt64"/>
  <data name="Fcb" inType="win:Pointer" outType="win:HexInt64"/>
  <data name="FileNameLength" inType="win:UInt16" outType="xs:unsignedShort"/>
  <data name="FileName" inType="win:UnicodeString" outType="xs:string" length="FileNameLength"/>
  <data name="Status" inType="win:UInt32" outType="xs:unsignedInt"/>
</template>
]]></Template>
            </Event>
            <Event>
                <Id>30504</Id>
                <Version>0</Version>
                <Channel>Microsoft-Windows-SMBClient/XPerfAnalytic</Channel>
                <Level>Verbose</Level>
                <Keyword>InfoCache_Info</Keyword>
                <Message><![CDATA[
SMB update file not found cache: RxContext %1 Fcb %2 FileName %4]]></Message>
                <Template><![CDATA[
<template xmlns="http://schemas.microsoft.com/win/2004/08/events">
  <data name="RxContext" inType="win:Pointer" outType="win:HexInt64"/>
  <data name="Fcb" inType="win:Pointer" outType="win:HexInt64"/>
  <data name="FileNameLength" inType="win:UInt16" outType="xs:unsignedShort"/>
  <data name="FileName" inType="win:UnicodeString" outType="xs:string" length="FileNameLength"/>
  <data name="Status" inType="win:UInt32" outType="xs:unsignedInt"/>
</template>
]]></Template>
            </Event>
            <Event>
                <Id>30505</Id>
                <Version>0</Version>
                <Channel>Microsoft-Windows-SMBClient/XPerfAnalytic</Channel>
                <Level>Verbose</Level>
                <Keyword>InfoCache_Info</Keyword>
                <Message><![CDATA[
SMB fetch file not found cache: RxContext %1 Fcb %2 FileName %4 Result %5]]></Message>
                <Template><![CDATA[
<template xmlns="http://schemas.microsoft.com/win/2004/08/events">
  <data name="RxContext" inType="win:Pointer" outType="win:HexInt64"/>
  <data name="Fcb" inType="win:Pointer" outType="win:HexInt64"/>
  <data name="FileNameLength" inType="win:UInt16" outType="xs:unsignedShort"/>
  <data name="FileName" inType="win:UnicodeString" outType="xs:string" length="FileNameLength"/>
  <data name="Status" inType="win:UInt32" outType="xs:unsignedInt"/>
</template>
]]></Template>
            </Event>
            <Event>
                <Id>30506</Id>
                <Version>0</Version>
                <Channel>Microsoft-Windows-SMBClient/XPerfAnalytic</Channel>
                <Level>Verbose</Level>
                <Keyword>InfoCache_Info</Keyword>
                <Message><![CDATA[
SMB invalidate file not found cache: RxContext %1 Fcb %2 FileName %4]]></Message>
                <Template><![CDATA[
<template xmlns="http://schemas.microsoft.com/win/2004/08/events">
  <data name="RxContext" inType="win:Pointer" outType="win:HexInt64"/>
  <data name="Fcb" inType="win:Pointer" outType="win:HexInt64"/>
  <data name="FileNameLength" inType="win:UInt16" outType="xs:unsignedShort"/>
  <data name="FileName" inType="win:UnicodeString" outType="xs:string" length="FileNameLength"/>
  <data name="Status" inType="win:UInt32" outType="xs:unsignedInt"/>
</template>
]]></Template>
            </Event>
            <Event>
                <Id>30507</Id>
                <Version>0</Version>
                <Channel>Microsoft-Windows-SMBClient/XPerfAnalytic</Channel>
                <Level>Verbose</Level>
                <Keyword>InfoCache_Info</Keyword>
                <Message><![CDATA[
SMB populate dir cache: RxContext %1 Fcb %2 DirName %4]]></Message>
                <Template><![CDATA[
<template xmlns="http://schemas.microsoft.com/win/2004/08/events">
  <data name="RxContext" inType="win:Pointer" outType="win:HexInt64"/>
  <data name="Fcb" inType="win:Pointer" outType="win:HexInt64"/>
  <data name="FileNameLength" inType="win:UInt16" outType="xs:unsignedShort"/>
  <data name="FileName" inType="win:UnicodeString" outType="xs:string" length="FileNameLength"/>
  <data name="Status" inType="win:UInt32" outType="xs:unsignedInt"/>
</template>
]]></Template>
            </Event>
            <Event>
                <Id>30508</Id>
                <Version>0</Version>
                <Channel>Microsoft-Windows-SMBClient/XPerfAnalytic</Channel>
                <Level>Verbose</Level>
                <Keyword>InfoCache_Info</Keyword>
                <Message><![CDATA[
SMB fetch dir cache: RxContext %1 Fcb %2 FileName %4 Status %5]]></Message>
                <Template><![CDATA[
<template xmlns="http://schemas.microsoft.com/win/2004/08/events">
  <data name="RxContext" inType="win:Pointer" outType="win:HexInt64"/>
  <data name="Fcb" inType="win:Pointer" outType="win:HexInt64"/>
  <data name="FileNameLength" inType="win:UInt16" outType="xs:unsignedShort"/>
  <data name="FileName" inType="win:UnicodeString" outType="xs:string" length="FileNameLength"/>
  <data name="Status" inType="win:UInt32" outType="xs:unsignedInt"/>
</template>
]]></Template>
            </Event>
            <Event>
                <Id>30600</Id>
                <Version>0</Version>
                <Channel>Microsoft-Windows-SMBClient/ObjectStateDiagnostic</Channel>
                <Level>Information</Level>
                <Keyword>Smb_TFO</Keyword>
                <Message><![CDATA[
Session %1 to %6 transitioned from [%2] to [%3] with Status %4]]></Message>
                <Template><![CDATA[
<template xmlns="http://schemas.microsoft.com/win/2004/08/events">
  <data name="Object" inType="win:Pointer" outType="win:HexInt64"/>
  <data name="OldState" inType="win:UInt16" outType="xs:unsignedShort"/>
  <data name="NewState" inType="win:UInt16" outType="xs:unsignedShort"/>
  <data name="Status" inType="win:UInt32" outType="win:HexInt32"/>
  <data name="NameLength" inType="win:UInt16" outType="xs:unsignedShort"/>
  <data name="ObjectName" inType="win:UnicodeString" outType="xs:string" length="NameLength"/>
</template>
]]></Template>
            </Event>
            <Event>
                <Id>30601</Id>
                <Version>0</Version>
                <Channel>Microsoft-Windows-SMBClient/ObjectStateDiagnostic</Channel>
                <Level>Information</Level>
                <Keyword>Smb_TFO</Keyword>
                <Message><![CDATA[
Share connection %1 to %6 transitioned from [%2] to [%3] with Status %4]]></Message>
                <Template><![CDATA[
<template xmlns="http://schemas.microsoft.com/win/2004/08/events">
  <data name="Object" inType="win:Pointer" outType="win:HexInt64"/>
  <data name="OldState" inType="win:UInt16" outType="xs:unsignedShort"/>
  <data name="NewState" inType="win:UInt16" outType="xs:unsignedShort"/>
  <data name="Status" inType="win:UInt32" outType="win:HexInt32"/>
  <data name="NameLength" inType="win:UInt16" outType="xs:unsignedShort"/>
  <data name="ObjectName" inType="win:UnicodeString" outType="xs:string" length="NameLength"/>
</template>
]]></Template>
            </Event>
            <Event>
                <Id>30603</Id>
                <Version>0</Version>
                <Channel>Microsoft-Windows-SMBClient/ObjectStateDiagnostic</Channel>
                <Level>Information</Level>
                <Keyword>Smb_TFO</Keyword>
                <Message><![CDATA[
Open handle %1 to %10%12 transitioned from [%5] to [%6] with Status %7]]></Message>
                <Template><![CDATA[
<template xmlns="http://schemas.microsoft.com/win/2004/08/events">
  <data name="Object" inType="win:Pointer" outType="win:HexInt64"/>
  <data name="PersistentFID" inType="win:UInt64" outType="win:HexInt64"/>
  <data name="VolatileFID" inType="win:UInt64" outType="win:HexInt64"/>
  <data name="CreateGUID" inType="win:GUID" outType="xs:GUID"/>
  <data name="OldState" inType="win:UInt16" outType="xs:unsignedShort"/>
  <data name="NewState" inType="win:UInt16" outType="xs:unsignedShort"/>
  <data name="Status" inType="win:UInt32" outType="win:NTStatus"/>
  <data name="Reason" inType="win:UInt32" outType="xs:unsignedInt"/>
  <data name="ShareNameLength" inType="win:UInt16" outType="xs:unsignedShort"/>
  <data name="ShareName" inType="win:UnicodeString" outType="xs:string" length="ShareNameLength"/>
  <data name="ObjectNameLength" inType="win:UInt16" outType="xs:unsignedShort"/>
  <data name="ObjectName" inType="win:UnicodeString" outType="xs:string" length="ObjectNameLength"/>
  <data name="PreviousStatus" inType="win:UInt32" outType="win:NTStatus"/>
  <data name="PreviousReason" inType="win:UInt32" outType="xs:unsignedInt"/>
</template>
]]></Template>
            </Event>
            <Event>
                <Id>30611</Id>
                <Version>2</Version>
                <Channel>Microsoft-Windows-SMBClient/Operational</Channel>
                <Level>Error</Level>
                <Keyword>Smb_TFO</Keyword>
                <Message><![CDATA[
Failed to reconnect a persistent handle.

Error: %7

FileId: %2:%3
CreateGUID: %4
Path: %10%12

Reason: %8

Previous reconnect error: %13
Previous reconnect reason: %14

Guidance:
A persistent handle allows transparent failover on Windows File Server clusters. This event has many causes and does not always indicate an issue with SMB. Review online documentation for troubleshooting information.]]></Message>
                <Template><![CDATA[
<template xmlns="http://schemas.microsoft.com/win/2004/08/events">
  <data name="Object" inType="win:Pointer" outType="win:HexInt64"/>
  <data name="PersistentFID" inType="win:UInt64" outType="win:HexInt64"/>
  <data name="VolatileFID" inType="win:UInt64" outType="win:HexInt64"/>
  <data name="CreateGUID" inType="win:GUID" outType="xs:GUID"/>
  <data name="OldState" inType="win:UInt16" outType="xs:unsignedShort"/>
  <data name="NewState" inType="win:UInt16" outType="xs:unsignedShort"/>
  <data name="Status" inType="win:UInt32" outType="win:NTStatus"/>
  <data name="Reason" inType="win:UInt32" outType="xs:unsignedInt"/>
  <data name="ShareNameLength" inType="win:UInt16" outType="xs:unsignedShort"/>
  <data name="ShareName" inType="win:UnicodeString" outType="xs:string" length="ShareNameLength"/>
  <data name="ObjectNameLength" inType="win:UInt16" outType="xs:unsignedShort"/>
  <data name="ObjectName" inType="win:UnicodeString" outType="xs:string" length="ObjectNameLength"/>
  <data name="PreviousStatus" inType="win:UInt32" outType="win:NTStatus"/>
  <data name="PreviousReason" inType="win:UInt32" outType="xs:unsignedInt"/>
</template>
]]></Template>
            </Event>
            <Event>
                <Id>30612</Id>
                <Version>2</Version>
                <Channel>Microsoft-Windows-SMBClient/Operational</Channel>
                <Level>Error</Level>
                <Keyword>Smb_TFO</Keyword>
                <Message><![CDATA[
Failed to reconnect a resilient handle.

Error: %7

FileId: %2:%3
Path: %10%12

Reason: %8.

Previous reconnect error: %13
Previous reconnect reason: %14

Guidance:
A resilient handle provides guarantees to applications requesting it. This event has many causes and does not always indicate an issue with SMB. Review online documentation for troubleshooting information.]]></Message>
                <Template><![CDATA[
<template xmlns="http://schemas.microsoft.com/win/2004/08/events">
  <data name="Object" inType="win:Pointer" outType="win:HexInt64"/>
  <data name="PersistentFID" inType="win:UInt64" outType="win:HexInt64"/>
  <data name="VolatileFID" inType="win:UInt64" outType="win:HexInt64"/>
  <data name="CreateGUID" inType="win:GUID" outType="xs:GUID"/>
  <data name="OldState" inType="win:UInt16" outType="xs:unsignedShort"/>
  <data name="NewState" inType="win:UInt16" outType="xs:unsignedShort"/>
  <data name="Status" inType="win:UInt32" outType="win:NTStatus"/>
  <data name="Reason" inType="win:UInt32" outType="xs:unsignedInt"/>
  <data name="ShareNameLength" inType="win:UInt16" outType="xs:unsignedShort"/>
  <data name="ShareName" inType="win:UnicodeString" outType="xs:string" length="ShareNameLength"/>
  <data name="ObjectNameLength" inType="win:UInt16" outType="xs:unsignedShort"/>
  <data name="ObjectName" inType="win:UnicodeString" outType="xs:string" length="ObjectNameLength"/>
  <data name="PreviousStatus" inType="win:UInt32" outType="win:NTStatus"/>
  <data name="PreviousReason" inType="win:UInt32" outType="xs:unsignedInt"/>
</template>
]]></Template>
            </Event>
            <Event>
                <Id>30613</Id>
                <Version>0</Version>
                <Channel>Microsoft-Windows-SMBClient/Operational</Channel>
                <Level>Error</Level>
                <Keyword>Smb_TFO</Keyword>
                <Message><![CDATA[
Failed to open a persistent handle.

Error: %7

FileId: %2:%3
CreateGUID: %4
Path: %10%12

Reason: %8

Guidance:
A persistent handle allows transparent failover on Windows File Server clusters. This event has many causes and does not always indicate an issue with SMB. Review online documentation for troubleshooting information.]]></Message>
                <Template><![CDATA[
<template xmlns="http://schemas.microsoft.com/win/2004/08/events">
  <data name="Object" inType="win:Pointer" outType="win:HexInt64"/>
  <data name="PersistentFID" inType="win:UInt64" outType="win:HexInt64"/>
  <data name="VolatileFID" inType="win:UInt64" outType="win:HexInt64"/>
  <data name="CreateGUID" inType="win:GUID" outType="xs:GUID"/>
  <data name="OldState" inType="win:UInt16" outType="xs:unsignedShort"/>
  <data name="NewState" inType="win:UInt16" outType="xs:unsignedShort"/>
  <data name="Status" inType="win:UInt32" outType="win:NTStatus"/>
  <data name="Reason" inType="win:UInt32" outType="xs:unsignedInt"/>
  <data name="ShareNameLength" inType="win:UInt16" outType="xs:unsignedShort"/>
  <data name="ShareName" inType="win:UnicodeString" outType="xs:string" length="ShareNameLength"/>
  <data name="ObjectNameLength" inType="win:UInt16" outType="xs:unsignedShort"/>
  <data name="ObjectName" inType="win:UnicodeString" outType="xs:string" length="ObjectNameLength"/>
  <data name="PreviousStatus" inType="win:UInt32" outType="win:NTStatus"/>
  <data name="PreviousReason" inType="win:UInt32" outType="xs:unsignedInt"/>
</template>
]]></Template>
            </Event>
            <Event>
                <Id>30701</Id>
                <Version>0</Version>
                <Channel>Microsoft-Windows-SMBClient/ObjectStateDiagnostic</Channel>
                <Level>Warning</Level>
                <Keyword>Smb_MultiChannel</Keyword>
                <Message><![CDATA[
An invalid FSCTL_QUERY_NETWORK_INTERFACE_INFO response was sent by the server %2]]></Message>
                <Template><![CDATA[
<template xmlns="http://schemas.microsoft.com/win/2004/08/events">
  <data name="ServerNameLength" inType="win:UInt16" outType="xs:unsignedShort"/>
  <data name="ServerName" inType="win:UnicodeString" outType="xs:string" length="ServerNameLength"/>
</template>
]]></Template>
            </Event>
            <Event>
                <Id>30702</Id>
                <Version>0</Version>
                <Channel>Microsoft-Windows-SMBClient/ObjectStateDiagnostic</Channel>
                <Level>Warning</Level>
                <Keyword>Smb_MultiChannel</Keyword>
                <Message><![CDATA[
The client failed to connect to the server %2 from the local IP address %4 to the remote IP address %6 over TCP transport. Error: %7]]></Message>
                <Template><![CDATA[
<template xmlns="http://schemas.microsoft.com/win/2004/08/events">
  <data name="ServerNameLength" inType="win:UInt16" outType="xs:unsignedShort"/>
  <data name="ServerName" inType="win:UnicodeString" outType="xs:string" length="ServerNameLength"/>
  <data name="LocalAddressLength" inType="win:UInt32" outType="xs:unsignedInt"/>
  <data name="LocalAddress" inType="win:Binary" outType="win:SocketAddress" length="LocalAddressLength"/>
  <data name="RemoteAddressLength" inType="win:UInt32" outType="xs:unsignedInt"/>
  <data name="RemoteAddress" inType="win:Binary" outType="win:SocketAddress" length="RemoteAddressLength"/>
  <data name="Status" inType="win:UInt32" outType="win:NTStatus"/>
</template>
]]></Template>
            </Event>
            <Event>
                <Id>30703</Id>
                <Version>0</Version>
                <Channel>Microsoft-Windows-SMBClient/ObjectStateDiagnostic</Channel>
                <Level>Warning</Level>
                <Keyword>Smb_MultiChannel</Keyword>
                <Message><![CDATA[
The client failed to connect to the server %2 from the local IP address %4 to the remote IP address %6 over RDMA transport. Error: %7]]></Message>
                <Template><![CDATA[
<template xmlns="http://schemas.microsoft.com/win/2004/08/events">
  <data name="ServerNameLength" inType="win:UInt16" outType="xs:unsignedShort"/>
  <data name="ServerName" inType="win:UnicodeString" outType="xs:string" length="ServerNameLength"/>
  <data name="LocalAddressLength" inType="win:UInt32" outType="xs:unsignedInt"/>
  <data name="LocalAddress" inType="win:Binary" outType="win:SocketAddress" length="LocalAddressLength"/>
  <data name="RemoteAddressLength" inType="win:UInt32" outType="xs:unsignedInt"/>
  <data name="RemoteAddress" inType="win:Binary" outType="win:SocketAddress" length="RemoteAddressLength"/>
  <data name="Status" inType="win:UInt32" outType="win:NTStatus"/>
</template>
]]></Template>
            </Event>
            <Event>
                <Id>30704</Id>
                <Version>0</Version>
                <Channel>Microsoft-Windows-SMBClient/ObjectStateDiagnostic</Channel>
                <Level>Information</Level>
                <Keyword>Smb_MultiChannel</Keyword>
                <Message><![CDATA[
The client connected to the server %2 from the local IP address %4 to the remote IP address %6 over TCP transport successfully]]></Message>
                <Template><![CDATA[
<template xmlns="http://schemas.microsoft.com/win/2004/08/events">
  <data name="ServerNameLength" inType="win:UInt16" outType="xs:unsignedShort"/>
  <data name="ServerName" inType="win:UnicodeString" outType="xs:string" length="ServerNameLength"/>
  <data name="LocalAddressLength" inType="win:UInt32" outType="xs:unsignedInt"/>
  <data name="LocalAddress" inType="win:Binary" outType="win:SocketAddress" length="LocalAddressLength"/>
  <data name="RemoteAddressLength" inType="win:UInt32" outType="xs:unsignedInt"/>
  <data name="RemoteAddress" inType="win:Binary" outType="win:SocketAddress" length="RemoteAddressLength"/>
  <data name="Status" inType="win:UInt32" outType="win:NTStatus"/>
</template>
]]></Template>
            </Event>
            <Event>
                <Id>30705</Id>
                <Version>0</Version>
                <Channel>Microsoft-Windows-SMBClient/ObjectStateDiagnostic</Channel>
                <Level>Information</Level>
                <Keyword>Smb_MultiChannel</Keyword>
                <Message><![CDATA[
The client connected to the server %2 from the local IP address %4 to the remote IP address %6 over RDMA transport successfully]]></Message>
                <Template><![CDATA[
<template xmlns="http://schemas.microsoft.com/win/2004/08/events">
  <data name="ServerNameLength" inType="win:UInt16" outType="xs:unsignedShort"/>
  <data name="ServerName" inType="win:UnicodeString" outType="xs:string" length="ServerNameLength"/>
  <data name="LocalAddressLength" inType="win:UInt32" outType="xs:unsignedInt"/>
  <data name="LocalAddress" inType="win:Binary" outType="win:SocketAddress" length="LocalAddressLength"/>
  <data name="RemoteAddressLength" inType="win:UInt32" outType="xs:unsignedInt"/>
  <data name="RemoteAddress" inType="win:Binary" outType="win:SocketAddress" length="RemoteAddressLength"/>
  <data name="Status" inType="win:UInt32" outType="win:NTStatus"/>
</template>
]]></Template>
            </Event>
            <Event>
                <Id>30800</Id>
                <Version>0</Version>
                <Channel>Microsoft-Windows-SMBClient/Connectivity</Channel>
                <Level>Error</Level>
                <Keyword>Smb_Connectivity</Keyword>
                <Message><![CDATA[
The server name cannot be resolved.

Error: %2

Server name: %4

Guidance:
The client cannot resolve the server address in DNS or WINS. This issue often manifests immediately after joining a computer to the domain, when the client's DNS registration may not yet have propagated to all DNS servers. You should also expect this event at system startup on a DNS server (such as a domain controller) that points to itself for the primary DNS. You should validate the DNS client settings on this computer using IPCONFIG /ALL and NSLOOKUP.]]></Message>
                <Template><![CDATA[
<template xmlns="http://schemas.microsoft.com/win/2004/08/events">
  <data name="Reason" inType="win:UInt32" outType="xs:unsignedInt"/>
  <data name="Status" inType="win:UInt32" outType="win:NTStatus"/>
  <data name="ServerNameLength" inType="win:UInt16" outType="xs:unsignedShort"/>
  <data name="ServerName" inType="win:UnicodeString" outType="xs:string" length="ServerNameLength"/>
</template>
]]></Template>
            </Event>
            <Event>
                <Id>30801</Id>
                <Version>0</Version>
                <Channel>Microsoft-Windows-SMBClient/Connectivity</Channel>
                <Level>Error</Level>
                <Keyword>Smb_Connectivity</Keyword>
                <Message><![CDATA[
%1.

Error: %2

Server name: %4]]></Message>
                <Template><![CDATA[
<template xmlns="http://schemas.microsoft.com/win/2004/08/events">
  <data name="Reason" inType="win:UInt32" outType="xs:unsignedInt"/>
  <data name="Status" inType="win:UInt32" outType="win:NTStatus"/>
  <data name="ServerNameLength" inType="win:UInt16" outType="xs:unsignedShort"/>
  <data name="ServerName" inType="win:UnicodeString" outType="xs:string" length="ServerNameLength"/>
</template>
]]></Template>
            </Event>
            <Event>
                <Id>30802</Id>
                <Version>0</Version>
                <Channel>Microsoft-Windows-SMBClient/Connectivity</Channel>
                <Level>Error</Level>
                <Keyword>Smb_Connectivity</Keyword>
                <Message><![CDATA[
%1.

Error: %2

Server name: %4]]></Message>
                <Template><![CDATA[
<template xmlns="http://schemas.microsoft.com/win/2004/08/events">
  <data name="Reason" inType="win:UInt32" outType="xs:unsignedInt"/>
  <data name="Status" inType="win:UInt32" outType="win:NTStatus"/>
  <data name="ServerNameLength" inType="win:UInt16" outType="xs:unsignedShort"/>
  <data name="ServerName" inType="win:UnicodeString" outType="xs:string" length="ServerNameLength"/>
</template>
]]></Template>
            </Event>
            <Event>
                <Id>30803</Id>
                <Version>0</Version>
                <Channel>Microsoft-Windows-SMBClient/Connectivity</Channel>
                <Level>Error</Level>
                <Keyword>Smb_Connectivity</Keyword>
                <Message><![CDATA[
The network connection failed.

Error: %2

Server name: %4
Server address: %6
Connection type: %7

Guidance:
This indicates a problem with the underlying network or transport, such as with TCP/IP, and not with SMB. A firewall that blocks port 445 or 5445 can also cause this issue.]]></Message>
                <Template><![CDATA[
<template xmlns="http://schemas.microsoft.com/win/2004/08/events">
  <data name="Reason" inType="win:UInt32" outType="xs:unsignedInt"/>
  <data name="Status" inType="win:UInt32" outType="win:NTStatus"/>
  <data name="ServerNameLength" inType="win:UInt16" outType="xs:unsignedShort"/>
  <data name="ServerName" inType="win:UnicodeString" outType="xs:string" length="ServerNameLength"/>
  <data name="AddressLength" inType="win:UInt32" outType="xs:unsignedInt"/>
  <data name="Address" inType="win:Binary" outType="win:SocketAddress" length="AddressLength"/>
  <data name="ConnectionType" inType="win:UInt32" outType="xs:unsignedInt"/>
</template>
]]></Template>
            </Event>
            <Event>
                <Id>30804</Id>
                <Version>0</Version>
                <Channel>Microsoft-Windows-SMBClient/Connectivity</Channel>
                <Level>Error</Level>
                <Keyword>Smb_Connectivity</Keyword>
                <Message><![CDATA[
The network connection failed.

Error: %2

Server name: %4
Server address: %6
Connection type: %7

Guidance:
This indicates a problem with the underlying network or transport, such as with TCP/IP, and not with SMB. A firewall that blocks port 445 or 5445 can also cause this issue.]]></Message>
                <Template><![CDATA[
<template xmlns="http://schemas.microsoft.com/win/2004/08/events">
  <data name="Reason" inType="win:UInt32" outType="xs:unsignedInt"/>
  <data name="Status" inType="win:UInt32" outType="win:NTStatus"/>
  <data name="ServerNameLength" inType="win:UInt16" outType="xs:unsignedShort"/>
  <data name="ServerName" inType="win:UnicodeString" outType="xs:string" length="ServerNameLength"/>
  <data name="AddressLength" inType="win:UInt32" outType="xs:unsignedInt"/>
  <data name="Address" inType="win:Binary" outType="win:SocketAddress" length="AddressLength"/>
  <data name="ConnectionType" inType="win:UInt32" outType="xs:unsignedInt"/>
</template>
]]></Template>
            </Event>
            <Event>
                <Id>30805</Id>
                <Version>2</Version>
                <Channel>Microsoft-Windows-SMBClient/Connectivity</Channel>
                <Level>Warning</Level>
                <Keyword>Smb_Connectivity</Keyword>
                <Message><![CDATA[
The client lost its session to the server.

Error: %1

Server name: %5
Session ID: %2

Guidance:
If the server is a Windows Failover Cluster file server, then this message occurs when the file share moves between cluster nodes. There should also be an anti-event 30806 indicating the session to the server was re-established. If the server is not a failover cluster, it is likely that the server was previously online, but it is now inaccessible over the network.]]></Message>
                <Template><![CDATA[
<template xmlns="http://schemas.microsoft.com/win/2004/08/events">
  <data name="Status" inType="win:UInt32" outType="win:NTStatus"/>
  <data name="SessionId" inType="win:UInt64" outType="win:HexInt64"/>
  <data name="TreeId" inType="win:UInt32" outType="win:HexInt32"/>
  <data name="ServerNameLength" inType="win:UInt16" outType="xs:unsignedShort"/>
  <data name="ServerName" inType="win:UnicodeString" outType="xs:string" length="ServerNameLength"/>
  <data name="AddressLength" inType="win:UInt32" outType="xs:unsignedInt"/>
  <data name="Address" inType="win:Binary" outType="win:SocketAddress" length="AddressLength"/>
</template>
]]></Template>
            </Event>
            <Event>
                <Id>30806</Id>
                <Version>2</Version>
                <Channel>Microsoft-Windows-SMBClient/Connectivity</Channel>
                <Level>Information</Level>
                <Keyword>Smb_Connectivity</Keyword>
                <Message><![CDATA[
The client re-established its session to the server.

Server name: %5
Server address: %7
Session ID: %2

Guidance:
You should expect this event if there was a previous event 30805, but the client successfully resumed the cached connection before the timeout expired.]]></Message>
                <Template><![CDATA[
<template xmlns="http://schemas.microsoft.com/win/2004/08/events">
  <data name="Status" inType="win:UInt32" outType="win:NTStatus"/>
  <data name="SessionId" inType="win:UInt64" outType="win:HexInt64"/>
  <data name="TreeId" inType="win:UInt32" outType="win:HexInt32"/>
  <data name="ServerNameLength" inType="win:UInt16" outType="xs:unsignedShort"/>
  <data name="ServerName" inType="win:UnicodeString" outType="xs:string" length="ServerNameLength"/>
  <data name="AddressLength" inType="win:UInt32" outType="xs:unsignedInt"/>
  <data name="Address" inType="win:Binary" outType="win:SocketAddress" length="AddressLength"/>
</template>
]]></Template>
            </Event>
            <Event>
                <Id>30807</Id>
                <Version>2</Version>
                <Channel>Microsoft-Windows-SMBClient/Connectivity</Channel>
                <Level>Warning</Level>
                <Keyword>Smb_Connectivity</Keyword>
                <Message><![CDATA[
The connection to the share was lost.

Error: %1

Share name: %5
Session ID: %2
Tree ID: %3

Guidance:
If the server is a Windows Failover Cluster file server, then this message occurs when the file share moves between cluster nodes. There should also be an anti-event 30808 indicating the session to the server was re-established. If the server is not a failover cluster, it is likely that the server was previously online, but it is now inaccessible over the network.]]></Message>
                <Template><![CDATA[
<template xmlns="http://schemas.microsoft.com/win/2004/08/events">
  <data name="Status" inType="win:UInt32" outType="win:NTStatus"/>
  <data name="SessionId" inType="win:UInt64" outType="win:HexInt64"/>
  <data name="TreeId" inType="win:UInt32" outType="win:HexInt32"/>
  <data name="ServerNameLength" inType="win:UInt16" outType="xs:unsignedShort"/>
  <data name="ServerName" inType="win:UnicodeString" outType="xs:string" length="ServerNameLength"/>
  <data name="AddressLength" inType="win:UInt32" outType="xs:unsignedInt"/>
  <data name="Address" inType="win:Binary" outType="win:SocketAddress" length="AddressLength"/>
</template>
]]></Template>
            </Event>
            <Event>
                <Id>30808</Id>
                <Version>2</Version>
                <Channel>Microsoft-Windows-SMBClient/Connectivity</Channel>
                <Level>Information</Level>
                <Keyword>Smb_Connectivity</Keyword>
                <Message><![CDATA[
The connection to the share was re-established.

Share name: %5
Server address: %7
Session ID: %2
Tree ID: %3

Guidance:
You should expect this event if there was a previous event 30807, but the client successfully resumed the cached connection before the timeout expired.]]></Message>
                <Template><![CDATA[
<template xmlns="http://schemas.microsoft.com/win/2004/08/events">
  <data name="Status" inType="win:UInt32" outType="win:NTStatus"/>
  <data name="SessionId" inType="win:UInt64" outType="win:HexInt64"/>
  <data name="TreeId" inType="win:UInt32" outType="win:HexInt32"/>
  <data name="ServerNameLength" inType="win:UInt16" outType="xs:unsignedShort"/>
  <data name="ServerName" inType="win:UnicodeString" outType="xs:string" length="ServerNameLength"/>
  <data name="AddressLength" inType="win:UInt32" outType="xs:unsignedInt"/>
  <data name="Address" inType="win:Binary" outType="win:SocketAddress" length="AddressLength"/>
</template>
]]></Template>
            </Event>
            <Event>
                <Id>30809</Id>
                <Version>0</Version>
                <Channel>Microsoft-Windows-SMBClient/Connectivity</Channel>
                <Level>Error</Level>
                <Keyword>Smb_Connectivity</Keyword>
                <Message><![CDATA[
A request timed out because there was no response from the server.

Server name: %6
Session ID:%3
Tree ID:%4
Message ID:%2
Command: %1

Guidance:
The server is responding over TCP but not over SMB. Ensure the Server service is running and responsive, and the disks do not have high per-IO latency, which makes the disks appear unresponsive to SMB. Also, ensure the server is responsive overall and not paused; for instance, make sure you can log on to it.]]></Message>
                <Template><![CDATA[
<template xmlns="http://schemas.microsoft.com/win/2004/08/events">
  <data name="Smb2Command" inType="win:UInt16" outType="xs:unsignedShort"/>
  <data name="MessageId" inType="win:UInt64" outType="win:HexInt64"/>
  <data name="SessionId" inType="win:UInt64" outType="win:HexInt64"/>
  <data name="TreeId" inType="win:UInt32" outType="win:HexInt32"/>
  <data name="ServerNameLength" inType="win:UInt16" outType="xs:unsignedShort"/>
  <data name="ServerName" inType="win:UnicodeString" outType="xs:string" length="ServerNameLength"/>
  <data name="Status" inType="win:UInt32" outType="win:NTStatus"/>
</template>
]]></Template>
            </Event>
            <Event>
                <Id>30810</Id>
                <Version>0</Version>
                <Channel>Microsoft-Windows-SMBClient/Connectivity</Channel>
                <Level>Information</Level>
                <Keyword>Smb_Connectivity</Keyword>
                <Message><![CDATA[
Added a TCP/IP transport interface.

Name: %2
InterfaceIndex: %3

Guidance:
A TCP/IP binding was added to the specified network adapter for the SMB client. The SMB client can now send and receive SMB traffic on this network adapter using TCP/IP. You should expect this event when a computer restarts or when a previously disabled network adaptor is re-enabled. No user action is required.]]></Message>
                <Template><![CDATA[
<template xmlns="http://schemas.microsoft.com/win/2004/08/events">
  <data name="NameLength" inType="win:UInt16" outType="xs:unsignedShort"/>
  <data name="Name" inType="win:UnicodeString" outType="xs:string" length="NameLength"/>
  <data name="IfIndex" inType="win:UInt32" outType="win:HexInt32"/>
</template>
]]></Template>
            </Event>
            <Event>
                <Id>30811</Id>
                <Version>0</Version>
                <Channel>Microsoft-Windows-SMBClient/Connectivity</Channel>
                <Level>Information</Level>
                <Keyword>Smb_Connectivity</Keyword>
                <Message><![CDATA[
Deleted a TCP/IP transport interface.

Name: %2
InterfaceIndex: %3

Guidance:
A TCP/IP binding was removed from the specified network adapter for the SMB client. You should expect this event when a computer shuts down or when a previously enabled network adaptor is disabled. No user action is required.]]></Message>
                <Template><![CDATA[
<template xmlns="http://schemas.microsoft.com/win/2004/08/events">
  <data name="NameLength" inType="win:UInt16" outType="xs:unsignedShort"/>
  <data name="Name" inType="win:UnicodeString" outType="xs:string" length="NameLength"/>
  <data name="IfIndex" inType="win:UInt32" outType="win:HexInt32"/>
</template>
]]></Template>
            </Event>
            <Event>
                <Id>30812</Id>
                <Version>0</Version>
                <Channel>Microsoft-Windows-SMBClient/Connectivity</Channel>
                <Level>Information</Level>
                <Keyword>Smb_Connectivity</Keyword>
                <Message><![CDATA[
Added a TDI transport interface.

Name: %2

Guidance:
A TDI (NetBIOS) binding was added to the specified network adapter for the SMB client. The SMB client can now send and receive SMB traffic on this network adapter using TDI. You should expect this event when a computer restarts or when a previously disabled network adaptor is re-enabled. No user action is required.]]></Message>
                <Template><![CDATA[
<template xmlns="http://schemas.microsoft.com/win/2004/08/events">
  <data name="ServerNameLength" inType="win:UInt16" outType="xs:unsignedShort"/>
  <data name="ServerName" inType="win:UnicodeString" outType="xs:string" length="ServerNameLength"/>
</template>
]]></Template>
            </Event>
            <Event>
                <Id>30813</Id>
                <Version>0</Version>
                <Channel>Microsoft-Windows-SMBClient/Connectivity</Channel>
                <Level>Information</Level>
                <Keyword>Smb_Connectivity</Keyword>
                <Message><![CDATA[
Deleted a TDI transport interface.

Name: %2

Guidance:
A TDI (NetBIOS) binding was removed from the specified network adapter for the SMB client. You should expect this event when a computer shuts down or when a previously enabled network adaptor is disabled. No user action is required.]]></Message>
                <Template><![CDATA[
<template xmlns="http://schemas.microsoft.com/win/2004/08/events">
  <data name="ServerNameLength" inType="win:UInt16" outType="xs:unsignedShort"/>
  <data name="ServerName" inType="win:UnicodeString" outType="xs:string" length="ServerNameLength"/>
</template>
]]></Template>
            </Event>
            <Event>
                <Id>30814</Id>
                <Version>0</Version>
                <Channel>Microsoft-Windows-SMBClient/Connectivity</Channel>
                <Level>Information</Level>
                <Keyword>Smb_Connectivity</Keyword>
                <Message><![CDATA[
Witness registration has completed.

Status: %1

Cluster share name: %4
Cluster share type: %2
File server cluster address: %6

Guidance:
The client successfully registered with the SMB Witness through RPC using TCP (port 135, then an endpoint port above 1023). No action is required.]]></Message>
                <Template><![CDATA[
<template xmlns="http://schemas.microsoft.com/win/2004/08/events">
  <data name="Status" inType="win:UInt32" outType="win:NTStatus"/>
  <data name="ShareType" inType="win:UInt8" outType="xs:unsignedByte"/>
  <data name="NameLength" inType="win:UInt16" outType="xs:unsignedShort"/>
  <data name="Name" inType="win:UnicodeString" outType="xs:string" length="NameLength"/>
  <data name="RemoteAddressLength" inType="win:UInt32" outType="xs:unsignedInt"/>
  <data name="RemoteAddress" inType="win:Binary" outType="win:SocketAddress" length="RemoteAddressLength"/>
</template>
]]></Template>
            </Event>
            <Event>
                <Id>30815</Id>
                <Version>0</Version>
                <Channel>Microsoft-Windows-SMBClient/Connectivity</Channel>
                <Level>Information</Level>
                <Keyword>Smb_Connectivity</Keyword>
                <Message><![CDATA[
Witness deregistration has completed.

Status: %1

Cluster share name: %4
Cluster share type: %2

Guidance:
The client successfully de-registered with the SMB Witness through RPC using TCP (port 135, then an endpoint port above 1023). No action is required.]]></Message>
                <Template><![CDATA[
<template xmlns="http://schemas.microsoft.com/win/2004/08/events">
  <data name="Status" inType="win:UInt32" outType="win:NTStatus"/>
  <data name="ShareType" inType="win:UInt8" outType="xs:unsignedByte"/>
  <data name="NameLength" inType="win:UInt16" outType="xs:unsignedShort"/>
  <data name="Name" inType="win:UnicodeString" outType="xs:string" length="NameLength"/>
  <data name="RemoteAddressLength" inType="win:UInt32" outType="xs:unsignedInt"/>
  <data name="RemoteAddress" inType="win:Binary" outType="win:SocketAddress" length="RemoteAddressLength"/>
</template>
]]></Template>
            </Event>
            <Event>
                <Id>30816</Id>
                <Version>0</Version>
                <Channel>Microsoft-Windows-SMBClient/Connectivity</Channel>
                <Level>Error</Level>
                <Keyword>Smb_Connectivity</Keyword>
                <Message><![CDATA[
The server failed the negotiate request.

Error: %2

Server name: %4

Guidance:
The server does not support any dialect that the client is trying to negotiate, such as the client has SMB2/SMB3 disabled and the server has SMB1 disabled.]]></Message>
                <Template><![CDATA[
<template xmlns="http://schemas.microsoft.com/win/2004/08/events">
  <data name="Reason" inType="win:UInt32" outType="xs:unsignedInt"/>
  <data name="Status" inType="win:UInt32" outType="win:NTStatus"/>
  <data name="ServerNameLength" inType="win:UInt16" outType="xs:unsignedShort"/>
  <data name="ServerName" inType="win:UnicodeString" outType="xs:string" length="ServerNameLength"/>
</template>
]]></Template>
            </Event>
            <Event>
                <Id>30817</Id>
                <Version>0</Version>
                <Channel>Microsoft-Windows-SMBClient/Connectivity</Channel>
                <Level>Error</Level>
                <Keyword>Smb_Connectivity</Keyword>
                <Message><![CDATA[
Close request failed.

Error: %2

Path: %4%6

Guidance:
A persistent handle (Continuous Availability) or a resilient handle failed to close.]]></Message>
                <Template><![CDATA[
<template xmlns="http://schemas.microsoft.com/win/2004/08/events">
  <data name="Reason" inType="win:UInt32" outType="xs:unsignedInt"/>
  <data name="Status" inType="win:UInt32" outType="win:NTStatus"/>
  <data name="ShareNameLength" inType="win:UInt16" outType="xs:unsignedShort"/>
  <data name="ShareName" inType="win:UnicodeString" outType="xs:string" length="ShareNameLength"/>
  <data name="ObjectNameLength" inType="win:UInt16" outType="xs:unsignedShort"/>
  <data name="ObjectName" inType="win:UnicodeString" outType="xs:string" length="ObjectNameLength"/>
</template>
]]></Template>
            </Event>
            <Event>
                <Id>30818</Id>
                <Version>0</Version>
                <Channel>Microsoft-Windows-SMBClient/Connectivity</Channel>
                <Level>Warning</Level>
                <Keyword>Smb_Connectivity</Keyword>
                <Message><![CDATA[
RDMA interfaces are available but the client failed to connect to the server over RDMA transport.

Server name: %2

Guidance:
Both client and server have RDMA (SMB Direct) adaptors but there was a problem with the connection and the client had to fall back to using TCP/IP SMB (non-RDMA).]]></Message>
                <Template><![CDATA[
<template xmlns="http://schemas.microsoft.com/win/2004/08/events">
  <data name="ServerNameLength" inType="win:UInt16" outType="xs:unsignedShort"/>
  <data name="ServerName" inType="win:UnicodeString" outType="xs:string" length="ServerNameLength"/>
</template>
]]></Template>
            </Event>
            <Event>
                <Id>30819</Id>
                <Version>2</Version>
                <Channel>Microsoft-Windows-SMBClient/Connectivity</Channel>
                <Level>Information</Level>
                <Keyword>Smb_TFO</Keyword>
                <Message><![CDATA[
The SMB client received a request to move to a different node on a file server cluster.

File server cluster name: %4
New file server cluster address: %6

Guidance:
Continuous Availability (Transparent Failover) is in use and the client computer is going to move to a different node after an SMB witness request over RPC using TCP (first contacting port 135, then contacting an endpoint port above 1023). No user action is required.]]></Message>
                <Template><![CDATA[
<template xmlns="http://schemas.microsoft.com/win/2004/08/events">
  <data name="Status" inType="win:UInt32" outType="win:NTStatus"/>
  <data name="ShareType" inType="win:UInt8" outType="xs:unsignedByte"/>
  <data name="NameLength" inType="win:UInt16" outType="xs:unsignedShort"/>
  <data name="Name" inType="win:UnicodeString" outType="xs:string" length="NameLength"/>
  <data name="RemoteAddressLength" inType="win:UInt32" outType="xs:unsignedInt"/>
  <data name="RemoteAddress" inType="win:Binary" outType="win:SocketAddress" length="RemoteAddressLength"/>
</template>
]]></Template>
            </Event>
            <Event>
                <Id>30820</Id>
                <Version>2</Version>
                <Channel>Microsoft-Windows-SMBClient/Connectivity</Channel>
                <Level>Information</Level>
                <Keyword>Smb_TFO</Keyword>
                <Message><![CDATA[
The SMB client successfully moved to a different node on a file server cluster.

File server cluster name: %4
 New file server cluster address: %6

Guidance:
Continuous Availability (Transparent Failover) is in use and the client computer successfully moved to a different node after an SMB witness request over RPC using TCP (first contacting port 135, then contacting an endpoint port above 1023). No user action is required.]]></Message>
                <Template><![CDATA[
<template xmlns="http://schemas.microsoft.com/win/2004/08/events">
  <data name="Status" inType="win:UInt32" outType="win:NTStatus"/>
  <data name="ShareType" inType="win:UInt8" outType="xs:unsignedByte"/>
  <data name="NameLength" inType="win:UInt16" outType="xs:unsignedShort"/>
  <data name="Name" inType="win:UnicodeString" outType="xs:string" length="NameLength"/>
  <data name="RemoteAddressLength" inType="win:UInt32" outType="xs:unsignedInt"/>
  <data name="RemoteAddress" inType="win:Binary" outType="win:SocketAddress" length="RemoteAddressLength"/>
</template>
]]></Template>
            </Event>
            <Event>
                <Id>30821</Id>
                <Version>2</Version>
                <Channel>Microsoft-Windows-SMBClient/Connectivity</Channel>
                <Level>Error</Level>
                <Keyword>Smb_TFO</Keyword>
                <Message><![CDATA[
The SMB client failed to move to a different node on a file server cluster.

Error: %1

File server cluster name: %4

Guidance:
Continuous Availability (Transparent Failover) is in use and the client computer failed to move to a different node after an SMB witness request over RPC using TCP (first contacting port 135, then contacting an endpoint port above 1023). The attempt to connect to the destination server failed, which is typically due to a network configuration issue. For example, this issue may occur if the destination node's IP address cannot be resolved, if the destination node is behind a firewall, or if there is no network route from the client to the node.]]></Message>
                <Template><![CDATA[
<template xmlns="http://schemas.microsoft.com/win/2004/08/events">
  <data name="Status" inType="win:UInt32" outType="win:NTStatus"/>
  <data name="ShareType" inType="win:UInt8" outType="xs:unsignedByte"/>
  <data name="NameLength" inType="win:UInt16" outType="xs:unsignedShort"/>
  <data name="Name" inType="win:UnicodeString" outType="xs:string" length="NameLength"/>
  <data name="RemoteAddressLength" inType="win:UInt32" outType="xs:unsignedInt"/>
  <data name="RemoteAddress" inType="win:Binary" outType="win:SocketAddress" length="RemoteAddressLength"/>
</template>
]]></Template>
            </Event>
            <Event>
                <Id>30900</Id>
                <Version>2</Version>
                <Channel>Microsoft-Windows-SMBClient/Operational</Channel>
                <Level>Warning</Level>
                <Keyword>Smb_TFO</Keyword>
                <Message><![CDATA[
The handle was created without persistence.

File ID: %2:%3
CreateGUID: %4
Path: %10%12

Guidance:
The server supports Continuous Availability (persistent handles) and the request to create the handle succeeded. However, the server did not grant persistence. You should verify that the Resume Key Filter is running on the server and is attached to the target volume.]]></Message>
                <Template><![CDATA[
<template xmlns="http://schemas.microsoft.com/win/2004/08/events">
  <data name="Object" inType="win:Pointer" outType="win:HexInt64"/>
  <data name="PersistentFID" inType="win:UInt64" outType="win:HexInt64"/>
  <data name="VolatileFID" inType="win:UInt64" outType="win:HexInt64"/>
  <data name="CreateGUID" inType="win:GUID" outType="xs:GUID"/>
  <data name="OldState" inType="win:UInt16" outType="xs:unsignedShort"/>
  <data name="NewState" inType="win:UInt16" outType="xs:unsignedShort"/>
  <data name="Status" inType="win:UInt32" outType="win:NTStatus"/>
  <data name="Reason" inType="win:UInt32" outType="xs:unsignedInt"/>
  <data name="ShareNameLength" inType="win:UInt16" outType="xs:unsignedShort"/>
  <data name="ShareName" inType="win:UnicodeString" outType="xs:string" length="ShareNameLength"/>
  <data name="ObjectNameLength" inType="win:UInt16" outType="xs:unsignedShort"/>
  <data name="ObjectName" inType="win:UnicodeString" outType="xs:string" length="ObjectNameLength"/>
  <data name="PreviousStatus" inType="win:UInt32" outType="win:NTStatus"/>
  <data name="PreviousReason" inType="win:UInt32" outType="xs:unsignedInt"/>
</template>
]]></Template>
            </Event>
            <Event>
                <Id>30904</Id>
                <Version>2</Version>
                <Channel>Microsoft-Windows-SMBClient/Operational</Channel>
                <Level>Information</Level>
                <Keyword>Smb_MultiChannel</Keyword>
                <Message><![CDATA[
The server does not support multichannel.

Server name: %2

Guidance:
The client attempted to use SMB Multichannel, but an administrator has disabled multichannel support on the server. This may also be a non-Microsoft file server that does not support multichannel or has multichannel disabled. You can enable SMB Multichannel on the server using this Windows PowerShell cmdlet: Set-SmbServerConfiguration -EnableMultiChannel:$true. This event does not apply to the multichannel settings of SMB client, which are controlled by the Set-SmbClientConfiguration Windows PowerShell cmdlet. Enabling or disabling client multichannel support does not affect server multichannel support.]]></Message>
                <Template><![CDATA[
<template xmlns="http://schemas.microsoft.com/win/2004/08/events">
  <data name="ServerNameLength" inType="win:UInt16" outType="xs:unsignedShort"/>
  <data name="ServerName" inType="win:UnicodeString" outType="xs:string" length="ServerNameLength"/>
</template>
]]></Template>
            </Event>
            <Event>
                <Id>30905</Id>
                <Version>2</Version>
                <Channel>Microsoft-Windows-SMBClient/Operational</Channel>
                <Level>Error</Level>
                <Keyword>Smb_MultiChannel</Keyword>
                <Message><![CDATA[
The client cannot connect to the server due to a multichannel constraint registry setting.

Server name: %2

Guidance:
The client attempted to use SMB Multichannel, but an administrator has configured multichannel support to prevent multichannel on the client. You can configure SMB Multichannel on the client using the Windows PowerShell cmdlets: New-SmbMultichannelConstraint and Remove-SmbMultichannelConstraint.]]></Message>
                <Template><![CDATA[
<template xmlns="http://schemas.microsoft.com/win/2004/08/events">
  <data name="ServerNameLength" inType="win:UInt16" outType="xs:unsignedShort"/>
  <data name="ServerName" inType="win:UnicodeString" outType="xs:string" length="ServerNameLength"/>
</template>
]]></Template>
            </Event>
            <Event>
                <Id>30906</Id>
                <Version>0</Version>
                <Channel>Microsoft-Windows-SMBClient/Operational</Channel>
                <Level>Error</Level>
                <Keyword>Smb_TFO</Keyword>
                <Message><![CDATA[
A request on persistent/resilient handle failed because the handle was invalid or it exceeded the timeout.

Status: %7

Type: %1
Path: %4%6
Restart count: %2

Guidance:
After retrying a request on a Continuously Available (Persistent) handle or a Resilient handle, the client was unable to reconnect the handle. This event is the result of a handle recovery failure. Review other events for more details.]]></Message>
                <Template><![CDATA[
<template xmlns="http://schemas.microsoft.com/win/2004/08/events">
  <data name="IrpCode" inType="win:UInt8" outType="xs:unsignedByte"/>
  <data name="RestartCount" inType="win:UInt32" outType="xs:unsignedInt"/>
  <data name="ShareNameLength" inType="win:UInt16" outType="xs:unsignedShort"/>
  <data name="ShareName" inType="win:UnicodeString" outType="xs:string" length="ShareNameLength"/>
  <data name="ObjectNameLength" inType="win:UInt16" outType="xs:unsignedShort"/>
  <data name="ObjectName" inType="win:UnicodeString" outType="xs:string" length="ObjectNameLength"/>
  <data name="Status" inType="win:UInt32" outType="win:NTStatus"/>
</template>
]]></Template>
            </Event>
            <Event>
                <Id>30907</Id>
                <Version>0</Version>
                <Channel>Microsoft-Windows-SMBClient/Operational</Channel>
                <Level>Warning</Level>
                <Keyword>Smb_MultiChannel</Keyword>
                <Message><![CDATA[
The SMB Multichannel registry value is not configured with default settings.

Default Registry Value:
[HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\LanmanWorkstation\Parameters]
"DisableMultiChannel"=dword:0
Configured Registry Value:
[HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\LanmanWorkstation\Parameters]
"DisableMultiChannel"=dword:%2

Guidance:
You can configure SMB Multichannel on the client using the Windows PowerShell cmdlet Set-SmbClientConfiguration. Disabling SMB client multichannel support is not a recommended configuration, as it can lead to degraded performance and decreased reliability if one channel or network path fails.]]></Message>
                <Template><![CDATA[
<template xmlns="http://schemas.microsoft.com/win/2004/08/events">
  <data name="RegName" inType="win:UnicodeString" outType="xs:string"/>
  <data name="RegValue" inType="win:UInt32" outType="xs:unsignedInt"/>
</template>
]]></Template>
            </Event>
            <Event>
                <Id>30908</Id>
                <Version>0</Version>
                <Channel>Microsoft-Windows-SMBClient/Operational</Channel>
                <Level>Warning</Level>
                <Keyword>Smb_Info</Keyword>
                <Message><![CDATA[
The SMB 3 and SMB 2 driver is not configured with the default start type.

Default Start Type: DEMAND_START
Configured Start Type: DISABLED

Guidance:
You should expect this event when disabling SMB2/SMB3 for the client using SC.EXE or editing the Windows registry. Microsoft does not recommend disabling SMB2/SMB3. Disabling SMB2/SMB3 prevents use of features such as SMB Transparent Failover, SMB Scale Out, SMB Multichannel, SMB Direct (RDMA), SMB Encryption, VSS for SMB file shares, and SMB Directory Leasing. SMB provides alternative troubleshooting workarounds to disabling SMB2/SMB3 in most cases.]]></Message>
                <Template><![CDATA[
<template xmlns="http://schemas.microsoft.com/win/2004/08/events">
  <data name="RegName" inType="win:UnicodeString" outType="xs:string"/>
  <data name="RegValue" inType="win:UInt32" outType="xs:unsignedInt"/>
</template>
]]></Template>
            </Event>
            <Event>
                <Id>30909</Id>
                <Version>0</Version>
                <Channel>Microsoft-Windows-SMBClient/Operational</Channel>
                <Level>Information</Level>
                <Keyword>Smb_Info</Keyword>
                <Message><![CDATA[
The client supports SMB Direct (RDMA) and SMB Signing is in use.

Share name: %2

Guidance:
For optimal SMB Direct performance, you can disable SMB Signing. This configuration is less secure and you should only consider this configuration on trustworthy private networks with strict access control.]]></Message>
                <Template><![CDATA[
<template xmlns="http://schemas.microsoft.com/win/2004/08/events">
  <data name="ServerNameLength" inType="win:UInt16" outType="xs:unsignedShort"/>
  <data name="ServerName" inType="win:UnicodeString" outType="xs:string" length="ServerNameLength"/>
</template>
]]></Template>
            </Event>
            <Event>
                <Id>30910</Id>
                <Version>0</Version>
                <Channel>Microsoft-Windows-SMBClient/Operational</Channel>
                <Level>Information</Level>
                <Keyword>Smb_Info</Keyword>
                <Message><![CDATA[
The client supports SMB Direct (RDMA) and SMB Encryption is in use.

Share name: %2

Guidance:
For optimal SMB Direct performance, you can disable SMB Encryption on the server for shares accessed by this client. This configuration is less secure and you should only consider this configuration on trustworthy private networks with strict access control.]]></Message>
                <Template><![CDATA[
<template xmlns="http://schemas.microsoft.com/win/2004/08/events">
  <data name="ServerNameLength" inType="win:UInt16" outType="xs:unsignedShort"/>
  <data name="ServerName" inType="win:UnicodeString" outType="xs:string" length="ServerNameLength"/>
</template>
]]></Template>
            </Event>
            <Event>
                <Id>31000</Id>
                <Version>0</Version>
                <Channel>Microsoft-Windows-SMBClient/Security</Channel>
                <Level>Error</Level>
                <Keyword>Smb_Authentication</Keyword>
                <Message><![CDATA[
%1.

Error: %2

Security status: %3
User name: %10
Logon ID: %4
Serrver name: %6]]></Message>
                <Template><![CDATA[
<template xmlns="http://schemas.microsoft.com/win/2004/08/events">
  <data name="Reason" inType="win:UInt32" outType="xs:unsignedInt"/>
  <data name="Status" inType="win:UInt32" outType="win:NTStatus"/>
  <data name="SecurityStatus" inType="win:UInt32" outType="win:HexInt32"/>
  <data name="LogonId" inType="win:UInt64" outType="win:HexInt64"/>
  <data name="ServerNameLength" inType="win:UInt16" outType="xs:unsignedShort"/>
  <data name="ServerName" inType="win:UnicodeString" outType="xs:string" length="ServerNameLength"/>
  <data name="PrincipalNameLength" inType="win:UInt16" outType="xs:unsignedShort"/>
  <data name="PrincipalName" inType="win:UnicodeString" outType="xs:string" length="PrincipalNameLength"/>
  <data name="UserNameLength" inType="win:UInt16" outType="xs:unsignedShort"/>
  <data name="UserName" inType="win:UnicodeString" outType="xs:string" length="UserNameLength"/>
</template>
]]></Template>
            </Event>
            <Event>
                <Id>31001</Id>
                <Version>0</Version>
                <Channel>Microsoft-Windows-SMBClient/Security</Channel>
                <Level>Error</Level>
                <Keyword>Smb_Authentication</Keyword>
                <Message><![CDATA[
%1.

Error: %2

Security status: %3
User name: %10
Logon ID: %4
Server name: %6
Principal name: %8]]></Message>
                <Template><![CDATA[
<template xmlns="http://schemas.microsoft.com/win/2004/08/events">
  <data name="Reason" inType="win:UInt32" outType="xs:unsignedInt"/>
  <data name="Status" inType="win:UInt32" outType="win:NTStatus"/>
  <data name="SecurityStatus" inType="win:UInt32" outType="win:HexInt32"/>
  <data name="LogonId" inType="win:UInt64" outType="win:HexInt64"/>
  <data name="ServerNameLength" inType="win:UInt16" outType="xs:unsignedShort"/>
  <data name="ServerName" inType="win:UnicodeString" outType="xs:string" length="ServerNameLength"/>
  <data name="PrincipalNameLength" inType="win:UInt16" outType="xs:unsignedShort"/>
  <data name="PrincipalName" inType="win:UnicodeString" outType="xs:string" length="PrincipalNameLength"/>
  <data name="UserNameLength" inType="win:UInt16" outType="xs:unsignedShort"/>
  <data name="UserName" inType="win:UnicodeString" outType="xs:string" length="UserNameLength"/>
</template>
]]></Template>
            </Event>
            <Event>
                <Id>31002</Id>
                <Version>0</Version>
                <Channel>Microsoft-Windows-SMBClient/Security</Channel>
                <Level>Error</Level>
                <Keyword>Smb_Authentication</Keyword>
                <Message><![CDATA[
The outbound authentication failed using a network token.

Error: %2

Server name: %4

Guidance:
This typically indicates that delegation must be configured for a Kerberos double-hop scenario. If delegation is configured, confirm that the services are configured correctly on the middle-tier server.]]></Message>
                <Template><![CDATA[
<template xmlns="http://schemas.microsoft.com/win/2004/08/events">
  <data name="Reason" inType="win:UInt32" outType="xs:unsignedInt"/>
  <data name="Status" inType="win:UInt32" outType="win:NTStatus"/>
  <data name="ServerNameLength" inType="win:UInt16" outType="xs:unsignedShort"/>
  <data name="ServerName" inType="win:UnicodeString" outType="xs:string" length="ServerNameLength"/>
</template>
]]></Template>
            </Event>
            <Event>
                <Id>31003</Id>
                <Version>0</Version>
                <Channel>Microsoft-Windows-SMBClient/Security</Channel>
                <Level>Warning</Level>
                <Keyword>Smb_Authentication</Keyword>
                <Message><![CDATA[
The LmCompatibilityLevel value is different from the default.

Configured LM Compatibility Level: %2
Default LM Compatibility Level: 3

Guidance:
LAN Manager (LM) authentication is the protocol used to authenticate Windows clients for network operations. This includes joining a domain, accessing network resources, and authenticating users or computers. This determines which challenge/response authentication protocol is negotiated between the client and the server computers. Specifically, the LM authentication level determines which authentication protocols the client will try to negotiate or the server will accept. The value set for LmCompatibilityLevel determines which challenge/response authentication protocol is used for network logons. This value affects the level of authentication protocol that clients use, the level of session security negotiated, and the level of authentication accepted by servers.

Value (Setting) - Description

0 (Send LM & NTLM responses) - Clients use LM and NTLM authentication and never use NTLMv2 session security. Domain controllers accept LM, NTLM, and NTLMv2 authentication.

1 (Send LM & NTLM - use NTLMv2 session security if negotiated) - Clients use LM and NTLM authentication, and use NTLMv2 session security if the server supports it. Domain controllers accept LM, NTLM, and NTLMv2 authentication.

2 (Send NTLM response only) - Clients use NTLM authentication only and use NTLMv2 session security if the server supports it. Domain controllers accept LM, NTLM, and NTLMv2 authentication.

3 (Send NTLM v2 response only) - Clients use NTLMv2 authentication only and use NTLMv2 session security if the server supports it. Domain controllers accept LM, NTLM, and NTLMv2 authentication.

4 (Send NTLMv2 response only/refuse LM) - Clients use NTLMv2 authentication only and use NTLMv2 session security if the server supports it. Domain controllers refuse LM and accept only NTLM and NTLMv2 authentication.

5 (Send NTLM v2 response only/refuse LM & NTLM) - Clients use NTLMv2 authentication only and use NTLMv2 session security if the server supports it. Domain controllers refuse LM and NTLM and accept only NTLMv2 authentication.

Incompatibly configured  LmCompatibility levels between a client and server (such as 0 on a client and 5 on a server) prevent access to the server. Non-Microsoft clients and servers also provide these configuration settings.]]></Message>
                <Template><![CDATA[
<template xmlns="http://schemas.microsoft.com/win/2004/08/events">
  <data name="RegName" inType="win:UnicodeString" outType="xs:string"/>
  <data name="RegValue" inType="win:UInt32" outType="xs:unsignedInt"/>
</template>
]]></Template>
            </Event>
            <Event>
                <Id>31010</Id>
                <Version>0</Version>
                <Channel>Microsoft-Windows-SMBClient/Security</Channel>
                <Level>Error</Level>
                <Keyword>Smb_Authorization</Keyword>
                <Message><![CDATA[
The SMB client failed to connect to the share.

Error: %2

Path: %4%6]]></Message>
                <Template><![CDATA[
<template xmlns="http://schemas.microsoft.com/win/2004/08/events">
  <data name="Reason" inType="win:UInt32" outType="xs:unsignedInt"/>
  <data name="Status" inType="win:UInt32" outType="win:NTStatus"/>
  <data name="ShareNameLength" inType="win:UInt16" outType="xs:unsignedShort"/>
  <data name="ShareName" inType="win:UnicodeString" outType="xs:string" length="ShareNameLength"/>
  <data name="ObjectNameLength" inType="win:UInt16" outType="xs:unsignedShort"/>
  <data name="ObjectName" inType="win:UnicodeString" outType="xs:string" length="ObjectNameLength"/>
</template>
]]></Template>
            </Event>
            <Event>
                <Id>31012</Id>
                <Version>0</Version>
                <Channel>Microsoft-Windows-SMBClient/Security</Channel>
                <Level>Error</Level>
                <Keyword>Smb_Security</Keyword>
                <Message><![CDATA[
The negotiate validation failed.

From negotiate response:
Dialect: %1
SecurityMode: %2
Capabilities: %3
ServerGuid: %4

From FSCTL_VALIDATE_NEGOTIATE_INFO response:
Dialect: %5
SecurityMode: %6
Capabilities: %7
ServerGuid: %8

Guidance:
The client successfully negotiated SMB dialect, security mode, capabilities and server GUID with the server, but the validation of these values then failed after connecting to a share. This may be due to a "man-in-the-middle" compromise attempt.]]></Message>
                <Template><![CDATA[
<template xmlns="http://schemas.microsoft.com/win/2004/08/events">
  <data name="Dialect" inType="win:UInt16" outType="win:HexInt16"/>
  <data name="SecurityMode" inType="win:UInt16" outType="win:HexInt16"/>
  <data name="Capabilities" inType="win:UInt32" outType="win:HexInt32"/>
  <data name="Guid" inType="win:GUID" outType="xs:GUID"/>
  <data name="Dialect2" inType="win:UInt16" outType="win:HexInt16"/>
  <data name="SecurityMode2" inType="win:UInt16" outType="win:HexInt16"/>
  <data name="Capabilities2" inType="win:UInt32" outType="win:HexInt32"/>
  <data name="Guid2" inType="win:GUID" outType="xs:GUID"/>
</template>
]]></Template>
            </Event>
            <Event>
                <Id>31013</Id>
                <Version>0</Version>
                <Channel>Microsoft-Windows-SMBClient/Security</Channel>
                <Level>Error</Level>
                <Keyword>Smb_Security</Keyword>
                <Message><![CDATA[
The signing validation failed.

Error:%7

Server name: %6
Session ID:%3
Tree ID:%4
Message ID:%2
Command: %1

Guidance:
This error indicates that SMB messages are being modified in transit across the network from the server to the client. This may be due to the session ending on the server, a problem with the network, a problem with a third-party SMB server, or a "man-in-the-middle" compromise attempt.]]></Message>
                <Template><![CDATA[
<template xmlns="http://schemas.microsoft.com/win/2004/08/events">
  <data name="Smb2Command" inType="win:UInt16" outType="xs:unsignedShort"/>
  <data name="MessageId" inType="win:UInt64" outType="win:HexInt64"/>
  <data name="SessionId" inType="win:UInt64" outType="win:HexInt64"/>
  <data name="TreeId" inType="win:UInt32" outType="win:HexInt32"/>
  <data name="ServerNameLength" inType="win:UInt16" outType="xs:unsignedShort"/>
  <data name="ServerName" inType="win:UnicodeString" outType="xs:string" length="ServerNameLength"/>
  <data name="Status" inType="win:UInt32" outType="win:NTStatus"/>
</template>
]]></Template>
            </Event>
            <Event>
                <Id>31014</Id>
                <Version>0</Version>
                <Channel>Microsoft-Windows-SMBClient/Security</Channel>
                <Level>Error</Level>
                <Keyword>Smb_Security</Keyword>
                <Message><![CDATA[
The client received an unencrypted message when encryption was expected.

Server name: %6
Session ID:%3
Tree ID:%4
Message ID:%2
Command: %1

Guidance:
This error indicates that SMB messages are being modified in transit across the network from the server to the client. This may be due to the session ending on the server, a problem with the network, a problem with a third-party SMB server, or a "man-in-the-middle" compromise attempt.]]></Message>
                <Template><![CDATA[
<template xmlns="http://schemas.microsoft.com/win/2004/08/events">
  <data name="Smb2Command" inType="win:UInt16" outType="xs:unsignedShort"/>
  <data name="MessageId" inType="win:UInt64" outType="win:HexInt64"/>
  <data name="SessionId" inType="win:UInt64" outType="win:HexInt64"/>
  <data name="TreeId" inType="win:UInt32" outType="win:HexInt32"/>
  <data name="ServerNameLength" inType="win:UInt16" outType="xs:unsignedShort"/>
  <data name="ServerName" inType="win:UnicodeString" outType="xs:string" length="ServerNameLength"/>
  <data name="Status" inType="win:UInt32" outType="win:NTStatus"/>
</template>
]]></Template>
            </Event>
            <Event>
                <Id>31015</Id>
                <Version>0</Version>
                <Channel>Microsoft-Windows-SMBClient/Security</Channel>
                <Level>Error</Level>
                <Keyword>Smb_Security</Keyword>
                <Message><![CDATA[
Failed to decrypt an encrypted SMB message.

Error:%7

Server name: %6
Session ID:%3

Guidance:
The client received an encrypted SMB message but cannot decrypt the data. This typically means that the communication came from a previous session that no longer exists. The encryption header may also have been damaged or tampered with on the network between the client and server.]]></Message>
                <Template><![CDATA[
<template xmlns="http://schemas.microsoft.com/win/2004/08/events">
  <data name="Smb2Command" inType="win:UInt16" outType="xs:unsignedShort"/>
  <data name="MessageId" inType="win:UInt64" outType="win:HexInt64"/>
  <data name="SessionId" inType="win:UInt64" outType="win:HexInt64"/>
  <data name="TreeId" inType="win:UInt32" outType="win:HexInt32"/>
  <data name="ServerNameLength" inType="win:UInt16" outType="xs:unsignedShort"/>
  <data name="ServerName" inType="win:UnicodeString" outType="xs:string" length="ServerNameLength"/>
  <data name="Status" inType="win:UInt32" outType="win:NTStatus"/>
</template>
]]></Template>
            </Event>
            <Event>
                <Id>31016</Id>
                <Version>0</Version>
                <Channel>Microsoft-Windows-SMBClient/Security</Channel>
                <Level>Warning</Level>
                <Keyword>Smb_Security</Keyword>
                <Message><![CDATA[
The SMB Signing registry value is not configured with default settings.

Default Registry Value:
[HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\LanmanWorkstation\Parameters]
"EnableSecuritySignature"=dword:1
Configured Registry Value:
[HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\LanmanWorkstation\Parameters]
"EnableSecuritySignature"=dword:0

Guidance:
Even though you can disable, enable, or require SMB Signing, the negotiation rules changed starting with SMB2 and not all combinations operate like SMB1.

The effective behavior for SMB2/SMB3 is:
Client Required and Server Required = Signed
Client Not Required and Server Required = Signed
Server Required and Client Not Required = Signed
Server Not Required and Client Not Required = Not Signed

When requiring SMB Encryption, SMB Signing is not used, regardless of settings. SMB Encryption implicitly provides the same integrity guarantees as SMB Signing.]]></Message>
                <Template><![CDATA[
<template xmlns="http://schemas.microsoft.com/win/2004/08/events">
  <data name="RegName" inType="win:UnicodeString" outType="xs:string"/>
  <data name="RegValue" inType="win:UInt32" outType="xs:unsignedInt"/>
</template>
]]></Template>
            </Event>
            <Event>
                <Id>40000</Id>
                <Version>0</Version>
                <Channel>Microsoft-Windows-SMBClient/Diagnostic</Channel>
                <Level>Information</Level>
                <Message><![CDATA[
Packet (%4 bytes)]]></Message>
                <Template><![CDATA[
<template xmlns="http://schemas.microsoft.com/win/2004/08/events">
  <data name="ConnectionType" inType="win:UInt32" outType="xs:unsignedInt"/>
  <data name="PeerAddressLength" inType="win:UInt32" outType="xs:unsignedInt"/>
  <data name="PeerAddress" inType="win:Binary" outType="win:SocketAddress" length="PeerAddressLength"/>
  <data name="PacketSize" inType="win:UInt32" outType="xs:unsignedInt"/>
  <data name="PacketData" inType="win:Binary" outType="xs:hexBinary" length="PacketSize"/>
</template>
]]></Template>
            </Event>
        </EventMetadata>
    </Provider>
</Providers>
